{"config":{"lang":["en"],"separator":"[\\s\\-,:!=\\[\\]()\"`/]+|\\.(?!\\d)|&[lg]t;|(?!\\b)(?=[A-Z][a-z])","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Vault Access Operator","text":"<p>A Kubernetes operator for managing HashiCorp Vault access policies and Kubernetes authentication roles declaratively through Custom Resource Definitions (CRDs).</p> <ul> <li> <p>:material-rocket-launch:{ .lg .middle } Get Started in 5 Minutes</p> <p>Install the operator and create your first VaultConnection, VaultPolicy, and VaultRole.</p> <p>:octicons-arrow-right-24: Quick Start</p> </li> <li> <p>:material-cog:{ .lg .middle } Configuration Reference</p> <p>Complete Helm chart configuration options and example values files.</p> <p>:octicons-arrow-right-24: Configuration</p> </li> <li> <p>:material-book-open-variant:{ .lg .middle } API Reference</p> <p>Detailed documentation for all Custom Resource Definitions.</p> <p>:octicons-arrow-right-24: API Reference</p> </li> <li> <p>:material-lifebuoy:{ .lg .middle } Troubleshooting</p> <p>Common issues, debugging techniques, and solutions.</p> <p>:octicons-arrow-right-24: Troubleshooting</p> </li> </ul>"},{"location":"#overview","title":"Overview","text":"<p>The Vault Access Operator enables platform teams to manage Vault policies and Kubernetes authentication roles using native Kubernetes resources. It provides a GitOps-friendly approach to Vault access management, allowing teams to version control their Vault configurations alongside their application deployments.</p>"},{"location":"#features","title":"Features","text":"<ul> <li>Declarative Vault Policy Management - Define Vault policies as Kubernetes resources</li> <li>Kubernetes Auth Role Management - Configure Vault Kubernetes authentication roles through CRDs</li> <li>Namespace Boundary Enforcement - Automatically restrict namespaced policies to their namespace scope</li> <li>Multiple Authentication Methods - Support for Kubernetes, Token, and AppRole authentication</li> <li>Conflict Detection and Handling - Choose between fail-fast or adopt strategies for existing resources</li> <li>Automatic Policy Generation - Generate Vault HCL policies from structured rule definitions</li> <li>Variable Substitution - Use <code>{{namespace}}</code> and <code>{{name}}</code> variables in policy paths</li> <li>Exponential Backoff Retry - Intelligent retry with jitter for transient failures</li> <li>Deletion Policies - Control whether Vault resources are retained or deleted when K8s resources are removed</li> <li>Admission Webhooks - Validate resources before creation with detailed error messages</li> </ul>"},{"location":"#quick-installation","title":"Quick Installation","text":"Helm (Recommended)kubectlFrom Source <pre><code># Add the Helm repository\nhelm repo add vault-access-operator https://panteparak.github.io/vault-access-operator/charts\n\n# Install the operator\nhelm install vault-access-operator vault-access-operator/vault-access-operator \\\n  --namespace vault-access-operator-system \\\n  --create-namespace\n</code></pre> <pre><code>kubectl apply -f https://raw.githubusercontent.com/panteparak/vault-access-operator/main/dist/install.yaml\n</code></pre> <pre><code>git clone https://github.com/panteparak/vault-access-operator.git\ncd vault-access-operator\nmake install\nmake deploy IMG=ghcr.io/panteparak/vault-access-operator:latest\n</code></pre> <p>For detailed installation instructions, see the Installation Guide.</p>"},{"location":"#custom-resource-definitions","title":"Custom Resource Definitions","text":"<p>The operator provides five CRDs for managing Vault access:</p> CRD Scope Description VaultConnection Cluster Establishes connection to Vault server VaultClusterPolicy Cluster Manages cluster-wide Vault policies VaultPolicy Namespaced Manages namespace-scoped Vault policies VaultClusterRole Cluster Manages cluster-wide Kubernetes auth roles VaultRole Namespaced Manages namespace-scoped Kubernetes auth roles"},{"location":"#architecture","title":"Architecture","text":"<pre><code>graph TB\n    subgraph Kubernetes\n        VC[VaultConnection]\n        VCP[VaultClusterPolicy]\n        VP[VaultPolicy]\n        VCR[VaultClusterRole]\n        VR[VaultRole]\n        OP[Vault Access Operator]\n    end\n\n    subgraph Vault\n        CONN[Connection]\n        POL[Policies]\n        ROLE[K8s Auth Roles]\n    end\n\n    VC --&gt; OP\n    VCP --&gt; OP\n    VP --&gt; OP\n    VCR --&gt; OP\n    VR --&gt; OP\n\n    OP --&gt; CONN\n    OP --&gt; POL\n    OP --&gt; ROLE</code></pre>"},{"location":"#prerequisites","title":"Prerequisites","text":"<ul> <li>Kubernetes cluster (v1.25+)</li> <li>HashiCorp Vault server</li> <li>cert-manager (for webhook certificates, optional)</li> <li>kubectl configured to access your cluster</li> </ul>"},{"location":"#community","title":"Community","text":"<ul> <li>GitHub Repository</li> <li>Issue Tracker</li> <li>Contributing Guide</li> </ul>"},{"location":"#license","title":"License","text":"<p>Copyright 2024-2026 Vault Access Operator Contributors.</p> <p>Licensed under the Apache License, Version 2.0.</p>"},{"location":"crd-reference/","title":"CRD Reference","text":"<p>This document provides detailed reference documentation for all Custom Resource Definitions (CRDs) provided by the Vault Access Operator.</p>"},{"location":"crd-reference/#table-of-contents","title":"Table of Contents","text":"<ul> <li>VaultConnection</li> <li>VaultClusterPolicy</li> <li>VaultPolicy</li> <li>VaultClusterRole</li> <li>VaultRole</li> <li>Common Types</li> </ul>"},{"location":"crd-reference/#vaultconnection","title":"VaultConnection","text":"<p>API Version: <code>vault.platform.io/v1alpha1</code> Kind: <code>VaultConnection</code> Scope: Cluster</p> <p>VaultConnection establishes and maintains a connection to a HashiCorp Vault server. It handles authentication and provides the connection for other resources to use.</p>"},{"location":"crd-reference/#spec-fields","title":"Spec Fields","text":"Field Type Required Default Description <code>address</code> string Yes - Vault server address (e.g., <code>https://vault.example.com:8200</code>). Must start with <code>http://</code> or <code>https://</code>. <code>tls</code> TLSConfig No - TLS configuration for the Vault connection. <code>auth</code> AuthConfig Yes - Authentication configuration for Vault. <code>defaults</code> ConnectionDefaults No - Default paths for various Vault operations. <code>healthCheckInterval</code> string No <code>30s</code> How often to check Vault connectivity (duration format)."},{"location":"crd-reference/#tlsconfig","title":"TLSConfig","text":"Field Type Required Default Description <code>skipVerify</code> boolean No <code>false</code> Skip TLS certificate verification. Not recommended for production. <code>caSecretRef</code> SecretKeySelector No - Reference to a secret containing the CA certificate."},{"location":"crd-reference/#authconfig","title":"AuthConfig","text":"<p>One of the following authentication methods must be configured:</p> Field Type Required Description <code>kubernetes</code> KubernetesAuth No Kubernetes auth method configuration. <code>token</code> TokenAuth No Token auth method configuration. <code>appRole</code> AppRoleAuth No AppRole auth method configuration."},{"location":"crd-reference/#kubernetesauth","title":"KubernetesAuth","text":"Field Type Required Default Description <code>role</code> string Yes - Vault role to authenticate as. <code>mountPath</code> string No <code>kubernetes</code> Mount path of the Kubernetes auth method. <code>serviceAccountTokenPath</code> string No <code>/var/run/secrets/kubernetes.io/serviceaccount/token</code> Path to the service account token."},{"location":"crd-reference/#tokenauth","title":"TokenAuth","text":"Field Type Required Description <code>secretRef</code> SecretKeySelector Yes Reference to a secret containing the Vault token."},{"location":"crd-reference/#approleauth","title":"AppRoleAuth","text":"Field Type Required Default Description <code>roleId</code> string Yes - AppRole role ID. <code>secretIdRef</code> SecretKeySelector Yes - Reference to a secret containing the AppRole secret ID. <code>mountPath</code> string No <code>approle</code> Mount path of the AppRole auth method."},{"location":"crd-reference/#connectiondefaults","title":"ConnectionDefaults","text":"Field Type Required Default Description <code>secretEnginePath</code> string No - Default path for secret engines. <code>transitPath</code> string No - Default path for the transit engine. <code>authPath</code> string No <code>auth/kubernetes</code> Default path for auth methods."},{"location":"crd-reference/#status-fields","title":"Status Fields","text":"Field Type Description <code>phase</code> string Current phase: <code>Pending</code>, <code>Syncing</code>, <code>Active</code>, <code>Error</code>. <code>vaultVersion</code> string Version of the connected Vault server. <code>lastHeartbeat</code> Time Time of the last successful health check. <code>conditions</code> []Condition Latest available observations. <code>message</code> string Additional information about the current state."},{"location":"crd-reference/#example","title":"Example","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultConnection\nmetadata:\n  name: vault-primary\nspec:\n  address: https://vault.example.com:8200\n  auth:\n    kubernetes:\n      role: vault-access-operator\n      mountPath: kubernetes\n  tls:\n    skipVerify: false\n    caSecretRef:\n      name: vault-ca-cert\n      namespace: vault-access-operator-system\n      key: ca.crt\n  healthCheckInterval: 30s\n  defaults:\n    authPath: auth/kubernetes\n</code></pre>"},{"location":"crd-reference/#vaultclusterpolicy","title":"VaultClusterPolicy","text":"<p>API Version: <code>vault.platform.io/v1alpha1</code> Kind: <code>VaultClusterPolicy</code> Scope: Cluster Short Name: <code>vcp</code></p> <p>VaultClusterPolicy manages cluster-wide Vault policies. The policy name in Vault matches the Kubernetes resource name.</p>"},{"location":"crd-reference/#spec-fields_1","title":"Spec Fields","text":"Field Type Required Default Description <code>connectionRef</code> string Yes - Name of the VaultConnection to use. <code>conflictPolicy</code> string No <code>Fail</code> How to handle conflicts: <code>Fail</code> or <code>Adopt</code>. <code>rules</code> []PolicyRule Yes - Policy rules (minimum 1 required). <code>deletionPolicy</code> string No <code>Delete</code> What happens when deleted: <code>Delete</code> or <code>Retain</code>."},{"location":"crd-reference/#status-fields_1","title":"Status Fields","text":"Field Type Description <code>phase</code> string Current phase: <code>Pending</code>, <code>Syncing</code>, <code>Active</code>, <code>Conflict</code>, <code>Error</code>, <code>Deleting</code>. <code>vaultName</code> string Name of the policy in Vault. <code>managed</code> boolean Whether this policy is managed by the operator. <code>rulesCount</code> integer Number of rules in the policy. <code>lastAppliedHash</code> string Hash of the last applied spec for change detection. <code>lastSyncedAt</code> Time Time of the last successful sync. <code>lastAttemptAt</code> Time Time of the last sync attempt. <code>retryCount</code> integer Number of retry attempts. <code>nextRetryAt</code> Time Time of the next retry attempt. <code>message</code> string Additional information about the current state. <code>conditions</code> []Condition Latest available observations."},{"location":"crd-reference/#example_1","title":"Example","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultClusterPolicy\nmetadata:\n  name: shared-secrets-reader\nspec:\n  connectionRef: vault-primary\n  conflictPolicy: Fail\n  deletionPolicy: Delete\n  rules:\n    - path: \"secret/data/shared/*\"\n      capabilities: [read, list]\n      description: \"Read access to shared secrets\"\n    - path: \"secret/metadata/shared/*\"\n      capabilities: [read, list]\n      description: \"Read metadata for shared secrets\"\n    - path: \"secret/data/global/config\"\n      capabilities: [read]\n      description: \"Read global configuration\"\n</code></pre>"},{"location":"crd-reference/#vaultpolicy","title":"VaultPolicy","text":"<p>API Version: <code>vault.platform.io/v1alpha1</code> Kind: <code>VaultPolicy</code> Scope: Namespaced Short Name: <code>vp</code></p> <p>VaultPolicy manages namespace-scoped Vault policies with optional namespace boundary enforcement. The policy name in Vault follows the format <code>{namespace}-{name}</code>.</p>"},{"location":"crd-reference/#spec-fields_2","title":"Spec Fields","text":"Field Type Required Default Description <code>connectionRef</code> string Yes - Name of the VaultConnection to use. <code>conflictPolicy</code> string No <code>Fail</code> How to handle conflicts: <code>Fail</code> or <code>Adopt</code>. <code>rules</code> []PolicyRule Yes - Policy rules (minimum 1 required). <code>deletionPolicy</code> string No <code>Delete</code> What happens when deleted: <code>Delete</code> or <code>Retain</code>. <code>enforceNamespaceBoundary</code> boolean No <code>false</code> Ensure all paths contain <code>{{namespace}}</code> variable."},{"location":"crd-reference/#namespace-boundary-enforcement","title":"Namespace Boundary Enforcement","text":"<p>When <code>enforceNamespaceBoundary</code> is <code>true</code>:</p> <ol> <li>All paths in rules must contain the <code>{{namespace}}</code> variable</li> <li>Wildcards (<code>*</code>) cannot appear before the <code>{{namespace}}</code> variable</li> <li>This prevents policies from accidentally granting access to other namespaces</li> </ol> <p>Valid paths: - <code>secret/data/{{namespace}}/*</code> - <code>secret/data/{{namespace}}/{{name}}/*</code> - <code>kv/data/apps/{{namespace}}/config</code></p> <p>Invalid paths (when enforcement is enabled): - <code>secret/data/*</code> (missing <code>{{namespace}}</code>) - <code>secret/*/{{namespace}}/data</code> (wildcard before namespace)</p>"},{"location":"crd-reference/#variable-substitution","title":"Variable Substitution","text":"<p>The following variables are substituted when the policy is applied:</p> Variable Description Example <code>{{namespace}}</code> Kubernetes namespace of the VaultPolicy <code>my-app</code> <code>{{name}}</code> Name of the VaultPolicy resource <code>app-secrets</code>"},{"location":"crd-reference/#status-fields_2","title":"Status Fields","text":"<p>Same as VaultClusterPolicy Status.</p>"},{"location":"crd-reference/#example_2","title":"Example","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultPolicy\nmetadata:\n  name: app-secrets\n  namespace: my-app\nspec:\n  connectionRef: vault-primary\n  enforceNamespaceBoundary: true\n  conflictPolicy: Fail\n  deletionPolicy: Delete\n  rules:\n    - path: \"secret/data/{{namespace}}/*\"\n      capabilities: [read, list]\n      description: \"Read secrets for this namespace\"\n    - path: \"secret/data/{{namespace}}/{{name}}/*\"\n      capabilities: [create, read, update, delete, list]\n      description: \"Full access to app-specific secrets\"\n    - path: \"database/creds/{{namespace}}-db\"\n      capabilities: [read]\n      description: \"Read database credentials\"\n</code></pre> <p>This creates a policy named <code>my-app-app-secrets</code> in Vault with paths: - <code>secret/data/my-app/*</code> - <code>secret/data/my-app/app-secrets/*</code> - <code>database/creds/my-app-db</code></p>"},{"location":"crd-reference/#vaultclusterrole","title":"VaultClusterRole","text":"<p>API Version: <code>vault.platform.io/v1alpha1</code> Kind: <code>VaultClusterRole</code> Scope: Cluster Short Name: <code>vcr</code></p> <p>VaultClusterRole manages cluster-wide Kubernetes auth roles in Vault. It can bind service accounts from any namespace to policies.</p>"},{"location":"crd-reference/#spec-fields_3","title":"Spec Fields","text":"Field Type Required Default Description <code>connectionRef</code> string Yes - Name of the VaultConnection to use. <code>authPath</code> string No - Mount path of the Kubernetes auth method. Uses VaultConnection default if not set. <code>conflictPolicy</code> string No <code>Fail</code> How to handle conflicts: <code>Fail</code> or <code>Adopt</code>. <code>serviceAccounts</code> []ServiceAccountRef Yes - Service accounts that can use this role (minimum 1 required). <code>policies</code> []PolicyReference Yes - Policies to attach to this role (minimum 1 required). <code>tokenTTL</code> string No - Default TTL for tokens (e.g., <code>1h</code>, <code>30m</code>). <code>tokenMaxTTL</code> string No - Maximum TTL for tokens. <code>deletionPolicy</code> string No <code>Delete</code> What happens when deleted: <code>Delete</code> or <code>Retain</code>."},{"location":"crd-reference/#status-fields_3","title":"Status Fields","text":"Field Type Description <code>phase</code> string Current phase: <code>Pending</code>, <code>Syncing</code>, <code>Active</code>, <code>Conflict</code>, <code>Error</code>, <code>Deleting</code>. <code>vaultRoleName</code> string Name of the role in Vault. <code>managed</code> boolean Whether this role is managed by the operator. <code>boundServiceAccounts</code> []string List of service accounts bound to this role. <code>resolvedPolicies</code> []string List of resolved Vault policy names. <code>lastSyncedAt</code> Time Time of the last successful sync. <code>lastAttemptAt</code> Time Time of the last sync attempt. <code>retryCount</code> integer Number of retry attempts. <code>nextRetryAt</code> Time Time of the next retry attempt. <code>message</code> string Additional information about the current state. <code>conditions</code> []Condition Latest available observations."},{"location":"crd-reference/#example_3","title":"Example","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultClusterRole\nmetadata:\n  name: platform-services\nspec:\n  connectionRef: vault-primary\n  authPath: auth/kubernetes\n  conflictPolicy: Fail\n  deletionPolicy: Delete\n  serviceAccounts:\n    - name: platform-controller\n      namespace: platform-system\n    - name: monitoring-agent\n      namespace: monitoring\n    - name: backup-operator\n      namespace: backup-system\n  policies:\n    - kind: VaultClusterPolicy\n      name: shared-secrets-reader\n    - kind: VaultClusterPolicy\n      name: platform-admin\n  tokenTTL: 1h\n  tokenMaxTTL: 24h\n</code></pre>"},{"location":"crd-reference/#vaultrole","title":"VaultRole","text":"<p>API Version: <code>vault.platform.io/v1alpha1</code> Kind: <code>VaultRole</code> Scope: Namespaced Short Name: <code>vr</code></p> <p>VaultRole manages namespace-scoped Kubernetes auth roles. Service accounts are restricted to the same namespace. The role name in Vault follows the format <code>{namespace}-{name}</code>.</p>"},{"location":"crd-reference/#spec-fields_4","title":"Spec Fields","text":"Field Type Required Default Description <code>connectionRef</code> string Yes - Name of the VaultConnection to use. <code>authPath</code> string No - Mount path of the Kubernetes auth method. Uses VaultConnection default if not set. <code>conflictPolicy</code> string No <code>Fail</code> How to handle conflicts: <code>Fail</code> or <code>Adopt</code>. <code>serviceAccounts</code> []string Yes - Service account names in the same namespace (minimum 1 required). <code>policies</code> []PolicyReference Yes - Policies to attach to this role (minimum 1 required). <code>tokenTTL</code> string No - Default TTL for tokens (e.g., <code>1h</code>, <code>30m</code>). <code>tokenMaxTTL</code> string No - Maximum TTL for tokens. <code>deletionPolicy</code> string No <code>Delete</code> What happens when deleted: <code>Delete</code> or <code>Retain</code>."},{"location":"crd-reference/#policy-resolution","title":"Policy Resolution","text":"<p>When referencing policies:</p> <ul> <li>VaultPolicy: If no namespace is specified, defaults to the VaultRole's namespace. The resolved Vault policy name is <code>{policyNamespace}-{policyName}</code>.</li> <li>VaultClusterPolicy: Namespace is ignored. The resolved Vault policy name matches the VaultClusterPolicy name.</li> </ul>"},{"location":"crd-reference/#status-fields_4","title":"Status Fields","text":"<p>Same as VaultClusterRole Status.</p>"},{"location":"crd-reference/#example_4","title":"Example","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultRole\nmetadata:\n  name: app-role\n  namespace: my-app\nspec:\n  connectionRef: vault-primary\n  conflictPolicy: Fail\n  deletionPolicy: Delete\n  serviceAccounts:\n    - default\n    - app-service-account\n    - worker-sa\n  policies:\n    - kind: VaultPolicy\n      name: app-secrets\n      # namespace defaults to my-app, resolves to: my-app-app-secrets\n    - kind: VaultPolicy\n      name: shared-policy\n      namespace: shared\n      # resolves to: shared-shared-policy\n    - kind: VaultClusterPolicy\n      name: shared-secrets-reader\n      # resolves to: shared-secrets-reader\n  tokenTTL: 1h\n  tokenMaxTTL: 4h\n</code></pre> <p>This creates a role named <code>my-app-app-role</code> in Vault.</p>"},{"location":"crd-reference/#common-types","title":"Common Types","text":""},{"location":"crd-reference/#policyrule","title":"PolicyRule","text":"<p>Defines a single policy rule for Vault.</p> Field Type Required Description <code>path</code> string Yes Path in Vault to apply the rule to. Pattern: <code>^[a-zA-Z0-9/_*{}\\-+]+$</code> <code>capabilities</code> []string Yes Capabilities to grant on this path. <code>description</code> string No Human-readable description of this rule. <code>parameters</code> PolicyParameters No Fine-grained parameter control."},{"location":"crd-reference/#valid-capabilities","title":"Valid Capabilities","text":"Capability Description <code>create</code> Create new data <code>read</code> Read data <code>update</code> Update existing data <code>delete</code> Delete data <code>list</code> List paths <code>sudo</code> Perform privileged operations <code>deny</code> Explicitly deny access (takes precedence)"},{"location":"crd-reference/#policyparameters","title":"PolicyParameters","text":"Field Type Description <code>allowed</code> []string Allowed parameter values. <code>denied</code> []string Denied parameter values. <code>required</code> []string Required parameters."},{"location":"crd-reference/#secretkeyselector","title":"SecretKeySelector","text":"<p>References a key in a Kubernetes Secret.</p> Field Type Required Default Description <code>name</code> string Yes - Name of the secret. <code>namespace</code> string No Resource's namespace Namespace of the secret. <code>key</code> string Yes - Key in the secret to select."},{"location":"crd-reference/#serviceaccountref","title":"ServiceAccountRef","text":"<p>References a Kubernetes ServiceAccount.</p> Field Type Required Description <code>name</code> string Yes Name of the service account. <code>namespace</code> string Yes Namespace of the service account."},{"location":"crd-reference/#policyreference","title":"PolicyReference","text":"<p>References a VaultPolicy or VaultClusterPolicy.</p> Field Type Required Default Description <code>kind</code> string Yes - Kind of the policy: <code>VaultPolicy</code> or <code>VaultClusterPolicy</code>. <code>name</code> string Yes - Name of the policy. <code>namespace</code> string No Referencing resource's namespace Namespace of the policy (only for VaultPolicy)."},{"location":"crd-reference/#condition","title":"Condition","text":"<p>Represents the status condition of a resource.</p> Field Type Description <code>type</code> string Type of condition: <code>Ready</code>, <code>Synced</code>, <code>ConnectionReady</code>, <code>PoliciesResolved</code>. <code>status</code> string Status: <code>True</code>, <code>False</code>, <code>Unknown</code>. <code>lastTransitionTime</code> Time Last time the condition transitioned. <code>reason</code> string Reason for the condition's last transition. <code>message</code> string Human-readable explanation. <code>observedGeneration</code> integer Generation observed by the controller."},{"location":"crd-reference/#condition-types","title":"Condition Types","text":"Type Description <code>Ready</code> Resource is fully reconciled and ready. <code>Synced</code> Resource has been synced to Vault. <code>ConnectionReady</code> VaultConnection is available and healthy. <code>PoliciesResolved</code> All referenced policies have been resolved."},{"location":"crd-reference/#condition-reasons","title":"Condition Reasons","text":"Reason Description <code>Succeeded</code> Operation completed successfully. <code>Failed</code> Operation failed. <code>InProgress</code> Operation is in progress. <code>Conflict</code> Conflict with existing Vault resource. <code>ValidationFailed</code> Validation failed. <code>ConnectionNotReady</code> VaultConnection is not ready. <code>PolicyNotFound</code> Referenced policy was not found."},{"location":"crd-reference/#conflict-and-deletion-policies","title":"Conflict and Deletion Policies","text":""},{"location":"crd-reference/#conflictpolicy","title":"ConflictPolicy","text":"<p>Controls how the operator handles conflicts with existing Vault resources.</p> Value Description <code>Fail</code> Fail if the resource already exists in Vault and is not managed by this operator. <code>Adopt</code> Take over management of existing resources, even if not previously managed."},{"location":"crd-reference/#deletionpolicy","title":"DeletionPolicy","text":"<p>Controls what happens to Vault resources when the Kubernetes resource is deleted.</p> Value Description <code>Delete</code> Delete the resource from Vault when the K8s resource is deleted. <code>Retain</code> Keep the resource in Vault even after the K8s resource is deleted."},{"location":"crd-reference/#resource-phases","title":"Resource Phases","text":"<p>All resources go through the following phases:</p> Phase Description <code>Pending</code> Resource is waiting to be processed. <code>Syncing</code> Resource is being synced to Vault. <code>Active</code> Resource has been successfully synced and is active. <code>Conflict</code> Resource has a conflict with an existing Vault resource. <code>Error</code> An error occurred during processing. <code>Deleting</code> Resource is being deleted from Vault."},{"location":"getting-started/","title":"Getting Started","text":"<p>This guide walks you through setting up the Vault Access Operator and creating your first Vault policies and roles.</p>"},{"location":"getting-started/#prerequisites","title":"Prerequisites","text":"<p>Before installing the Vault Access Operator, ensure you have the following:</p>"},{"location":"getting-started/#kubernetes-cluster","title":"Kubernetes Cluster","text":"<ul> <li>Kubernetes v1.25 or later</li> <li><code>kubectl</code> configured to access your cluster</li> <li>Cluster admin permissions for installing CRDs</li> </ul> <p>Verify your cluster:</p> <pre><code>kubectl version\nkubectl cluster-info\n</code></pre>"},{"location":"getting-started/#hashicorp-vault","title":"HashiCorp Vault","text":"<ul> <li>Vault server v1.12 or later</li> <li>Vault unsealed and accessible from your Kubernetes cluster</li> <li>Kubernetes authentication method enabled</li> </ul> <p>To enable the Kubernetes auth method in Vault:</p> <pre><code># Enable Kubernetes auth\nvault auth enable kubernetes\n\n# Configure Kubernetes auth (run from within the cluster or with appropriate access)\nvault write auth/kubernetes/config \\\n    kubernetes_host=\"https://$KUBERNETES_SERVICE_HOST:$KUBERNETES_SERVICE_PORT\" \\\n    kubernetes_ca_cert=@/var/run/secrets/kubernetes.io/serviceaccount/ca.crt\n</code></pre>"},{"location":"getting-started/#cert-manager","title":"cert-manager","text":"<p>cert-manager is required for managing webhook certificates:</p> <pre><code># Install cert-manager\nkubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.14.0/cert-manager.yaml\n\n# Wait for cert-manager to be ready\nkubectl wait --for=condition=Available deployment --all -n cert-manager --timeout=300s\n</code></pre>"},{"location":"getting-started/#installation","title":"Installation","text":""},{"location":"getting-started/#option-1-using-helm-recommended","title":"Option 1: Using Helm (Recommended)","text":"<pre><code># Add the Helm repository\nhelm repo add vault-access-operator https://panteparak.github.io/vault-access-operator\nhelm repo update\n\n# Create namespace\nkubectl create namespace vault-access-operator-system\n\n# Install the operator\nhelm install vault-access-operator vault-access-operator/vault-access-operator \\\n  --namespace vault-access-operator-system \\\n  --set webhook.certManager.enabled=true\n</code></pre>"},{"location":"getting-started/#option-2-using-kubectl","title":"Option 2: Using kubectl","text":"<pre><code># Apply the installation manifest\nkubectl apply -f https://raw.githubusercontent.com/panteparak/vault-access-operator/main/dist/install.yaml\n</code></pre>"},{"location":"getting-started/#option-3-from-source","title":"Option 3: From Source","text":"<pre><code># Clone the repository\ngit clone https://github.com/panteparak/vault-access-operator.git\ncd vault-access-operator\n\n# Install CRDs\nmake install\n\n# Deploy the operator\nmake deploy IMG=ghcr.io/panteparak/vault-access-operator:latest\n</code></pre>"},{"location":"getting-started/#verify-installation","title":"Verify Installation","text":"<pre><code># Check the operator is running\nkubectl get pods -n vault-access-operator-system\n\n# Check CRDs are installed\nkubectl get crds | grep vault.platform.io\n</code></pre> <p>You should see output similar to:</p> <pre><code>vaultclusterpolicies.vault.platform.io    2024-01-15T10:00:00Z\nvaultclusterroles.vault.platform.io       2024-01-15T10:00:00Z\nvaultconnections.vault.platform.io        2024-01-15T10:00:00Z\nvaultpolicies.vault.platform.io           2024-01-15T10:00:00Z\nvaultroles.vault.platform.io              2024-01-15T10:00:00Z\n</code></pre>"},{"location":"getting-started/#creating-a-vaultconnection","title":"Creating a VaultConnection","text":"<p>The first step is to establish a connection to your Vault server.</p>"},{"location":"getting-started/#step-1-create-vault-role-for-the-operator","title":"Step 1: Create Vault Role for the Operator","text":"<p>First, create a role in Vault that the operator will use to authenticate:</p> <pre><code># Create a policy for the operator\nvault policy write vault-access-operator - &lt;&lt;EOF\n# Manage policies\npath \"sys/policies/acl/*\" {\n  capabilities = [\"create\", \"read\", \"update\", \"delete\", \"list\"]\n}\n\n# List policies\npath \"sys/policies/acl\" {\n  capabilities = [\"list\"]\n}\n\n# Manage auth methods\npath \"auth/kubernetes/role/*\" {\n  capabilities = [\"create\", \"read\", \"update\", \"delete\", \"list\"]\n}\n\n# List auth roles\npath \"auth/kubernetes/role\" {\n  capabilities = [\"list\"]\n}\n\n# Check Vault health\npath \"sys/health\" {\n  capabilities = [\"read\"]\n}\n\n# Manage KV metadata (for managed markers)\npath \"secret/metadata/*\" {\n  capabilities = [\"create\", \"read\", \"update\", \"delete\", \"list\"]\n}\nEOF\n\n# Create a Kubernetes auth role for the operator\nvault write auth/kubernetes/role/vault-access-operator \\\n    bound_service_account_names=vault-access-operator-controller-manager \\\n    bound_service_account_namespaces=vault-access-operator-system \\\n    policies=vault-access-operator \\\n    ttl=1h\n</code></pre>"},{"location":"getting-started/#step-2-create-vaultconnection-resource","title":"Step 2: Create VaultConnection Resource","text":"<p>If your Vault uses TLS with a custom CA, first create a secret with the CA certificate:</p> <pre><code># Create secret with CA certificate (if using custom CA)\nkubectl create secret generic vault-ca-cert \\\n  --from-file=ca.crt=/path/to/ca.crt \\\n  -n vault-access-operator-system\n</code></pre> <p>Create the VaultConnection:</p> <pre><code># vault-connection.yaml\napiVersion: vault.platform.io/v1alpha1\nkind: VaultConnection\nmetadata:\n  name: vault-primary\nspec:\n  address: https://vault.example.com:8200\n  auth:\n    kubernetes:\n      role: vault-access-operator\n      mountPath: kubernetes\n  tls:\n    skipVerify: false\n    caSecretRef:\n      name: vault-ca-cert\n      namespace: vault-access-operator-system\n      key: ca.crt\n  healthCheckInterval: 30s\n  defaults:\n    authPath: auth/kubernetes\n</code></pre> <p>Apply the configuration:</p> <pre><code>kubectl apply -f vault-connection.yaml\n</code></pre>"},{"location":"getting-started/#step-3-verify-connection","title":"Step 3: Verify Connection","text":"<pre><code>kubectl get vaultconnection vault-primary\n\n# Check detailed status\nkubectl describe vaultconnection vault-primary\n</code></pre> <p>You should see the connection in <code>Active</code> phase:</p> <pre><code>NAME            ADDRESS                          PHASE    VERSION   AGE\nvault-primary   https://vault.example.com:8200   Active   1.15.0    1m\n</code></pre>"},{"location":"getting-started/#creating-your-first-policy","title":"Creating Your First Policy","text":""},{"location":"getting-started/#vaultclusterpolicy-cluster-wide","title":"VaultClusterPolicy (Cluster-wide)","text":"<p>Create a cluster-wide policy that grants read access to shared secrets:</p> <pre><code># shared-secrets-policy.yaml\napiVersion: vault.platform.io/v1alpha1\nkind: VaultClusterPolicy\nmetadata:\n  name: shared-secrets-reader\nspec:\n  connectionRef: vault-primary\n  conflictPolicy: Fail\n  deletionPolicy: Delete\n  rules:\n    - path: \"secret/data/shared/*\"\n      capabilities: [read, list]\n      description: \"Read access to shared secrets\"\n    - path: \"secret/metadata/shared/*\"\n      capabilities: [read, list]\n      description: \"Read metadata for shared secrets\"\n</code></pre> <p>Apply and verify:</p> <pre><code>kubectl apply -f shared-secrets-policy.yaml\n\n# Check status\nkubectl get vaultclusterpolicy shared-secrets-reader\nkubectl describe vaultclusterpolicy shared-secrets-reader\n</code></pre>"},{"location":"getting-started/#vaultpolicy-namespace-scoped","title":"VaultPolicy (Namespace-scoped)","text":"<p>Create a namespace-scoped policy with namespace boundary enforcement:</p> <pre><code># app-secrets-policy.yaml\napiVersion: vault.platform.io/v1alpha1\nkind: VaultPolicy\nmetadata:\n  name: app-secrets\n  namespace: my-app\nspec:\n  connectionRef: vault-primary\n  enforceNamespaceBoundary: true  # Explicitly enabled (default: false)\n  conflictPolicy: Fail\n  deletionPolicy: Delete\n  rules:\n    - path: \"secret/data/{{namespace}}/*\"\n      capabilities: [read, list]\n      description: \"Read secrets for this namespace\"\n    - path: \"secret/data/{{namespace}}/{{name}}/*\"\n      capabilities: [create, read, update, delete, list]\n      description: \"Full access to app-specific secrets\"\n</code></pre> <p>Apply and verify:</p> <pre><code># Create namespace if it doesn't exist\nkubectl create namespace my-app\n\nkubectl apply -f app-secrets-policy.yaml\n\n# Check status\nkubectl get vaultpolicy -n my-app\nkubectl describe vaultpolicy app-secrets -n my-app\n</code></pre> <p>The policy in Vault will be named <code>my-app-app-secrets</code> and the paths will be substituted to <code>secret/data/my-app/*</code>.</p>"},{"location":"getting-started/#creating-your-first-role","title":"Creating Your First Role","text":""},{"location":"getting-started/#vaultclusterrole-cluster-wide","title":"VaultClusterRole (Cluster-wide)","text":"<p>Create a cluster-wide role that binds service accounts to policies:</p> <pre><code># platform-services-role.yaml\napiVersion: vault.platform.io/v1alpha1\nkind: VaultClusterRole\nmetadata:\n  name: platform-services\nspec:\n  connectionRef: vault-primary\n  authPath: auth/kubernetes\n  conflictPolicy: Fail\n  deletionPolicy: Delete\n  serviceAccounts:\n    - name: platform-controller\n      namespace: platform-system\n    - name: monitoring-agent\n      namespace: monitoring\n  policies:\n    - kind: VaultClusterPolicy\n      name: shared-secrets-reader\n  tokenTTL: 1h\n  tokenMaxTTL: 24h\n</code></pre> <p>Apply and verify:</p> <pre><code>kubectl apply -f platform-services-role.yaml\n\n# Check status\nkubectl get vaultclusterrole platform-services\nkubectl describe vaultclusterrole platform-services\n</code></pre>"},{"location":"getting-started/#vaultrole-namespace-scoped","title":"VaultRole (Namespace-scoped)","text":"<p>Create a namespace-scoped role that binds service accounts within a namespace:</p> <pre><code># app-role.yaml\napiVersion: vault.platform.io/v1alpha1\nkind: VaultRole\nmetadata:\n  name: app-role\n  namespace: my-app\nspec:\n  connectionRef: vault-primary\n  conflictPolicy: Fail\n  deletionPolicy: Delete\n  serviceAccounts:\n    - default\n    - app-service-account\n  policies:\n    - kind: VaultPolicy\n      name: app-secrets\n    - kind: VaultClusterPolicy\n      name: shared-secrets-reader\n  tokenTTL: 1h\n  tokenMaxTTL: 4h\n</code></pre> <p>Apply and verify:</p> <pre><code>kubectl apply -f app-role.yaml\n\n# Check status\nkubectl get vaultrole -n my-app\nkubectl describe vaultrole app-role -n my-app\n</code></pre>"},{"location":"getting-started/#testing-authentication","title":"Testing Authentication","text":"<p>Test that the Vault authentication is working correctly:</p>"},{"location":"getting-started/#step-1-create-test-pod","title":"Step 1: Create Test Pod","text":"<pre><code># test-pod.yaml\napiVersion: v1\nkind: Pod\nmetadata:\n  name: vault-test\n  namespace: my-app\nspec:\n  serviceAccountName: default\n  containers:\n    - name: test\n      image: hashicorp/vault:latest\n      command: [\"sleep\", \"infinity\"]\n      env:\n        - name: VAULT_ADDR\n          value: \"https://vault.example.com:8200\"\n</code></pre> <pre><code>kubectl apply -f test-pod.yaml\n</code></pre>"},{"location":"getting-started/#step-2-authenticate-to-vault","title":"Step 2: Authenticate to Vault","text":"<pre><code># Get into the pod\nkubectl exec -it vault-test -n my-app -- /bin/sh\n\n# Login to Vault using Kubernetes auth\nvault login -method=kubernetes role=my-app-app-role\n\n# Test reading a secret (create one in Vault first)\nvault kv get secret/my-app/test-secret\n</code></pre>"},{"location":"getting-started/#step-3-verify-policy-enforcement","title":"Step 3: Verify Policy Enforcement","text":"<p>Try to access secrets outside the namespace:</p> <pre><code># This should fail with permission denied\nvault kv get secret/other-namespace/secret\n\n# This should succeed (if you have the shared-secrets-reader policy)\nvault kv get secret/shared/common-config\n</code></pre>"},{"location":"getting-started/#viewing-resource-status","title":"Viewing Resource Status","text":"<p>All resources expose their status through Kubernetes:</p> <pre><code># List all vault resources\nkubectl get vaultconnections\nkubectl get vaultclusterpolicies\nkubectl get vaultpolicies --all-namespaces\nkubectl get vaultclusterroles\nkubectl get vaultroles --all-namespaces\n\n# Get detailed status\nkubectl describe vaultconnection vault-primary\nkubectl describe vaultclusterpolicy shared-secrets-reader\nkubectl describe vaultpolicy app-secrets -n my-app\n\n# Check conditions\nkubectl get vaultpolicy app-secrets -n my-app -o jsonpath='{.status.conditions}'\n</code></pre>"},{"location":"getting-started/#next-steps","title":"Next Steps","text":"<ul> <li>Read the CRD Reference for detailed field documentation</li> <li>Check the Troubleshooting Guide if you encounter issues</li> <li>Explore advanced features like conflict policies and deletion policies</li> <li>Set up monitoring with Prometheus using ServiceMonitor</li> </ul>"},{"location":"installation/","title":"Installation","text":"<p>This guide covers all installation methods for the Vault Access Operator.</p>"},{"location":"installation/#prerequisites","title":"Prerequisites","text":"<p>Before installing the Vault Access Operator, ensure you have the following:</p>"},{"location":"installation/#kubernetes-cluster","title":"Kubernetes Cluster","text":"<ul> <li>Kubernetes v1.25 or later</li> <li><code>kubectl</code> configured to access your cluster</li> <li>Cluster admin permissions for installing CRDs</li> </ul> <p>Verify your cluster:</p> <pre><code>kubectl version\nkubectl cluster-info\n</code></pre>"},{"location":"installation/#hashicorp-vault","title":"HashiCorp Vault","text":"<ul> <li>Vault server v1.12 or later</li> <li>Vault unsealed and accessible from your Kubernetes cluster</li> <li>Kubernetes authentication method enabled (recommended)</li> </ul> <p>To enable the Kubernetes auth method in Vault:</p> <pre><code># Enable Kubernetes auth\nvault auth enable kubernetes\n\n# Configure Kubernetes auth (run from within the cluster or with appropriate access)\nvault write auth/kubernetes/config \\\n    kubernetes_host=\"https://$KUBERNETES_SERVICE_HOST:$KUBERNETES_SERVICE_PORT\" \\\n    kubernetes_ca_cert=@/var/run/secrets/kubernetes.io/serviceaccount/ca.crt\n</code></pre>"},{"location":"installation/#cert-manager-optional-but-recommended","title":"cert-manager (Optional but Recommended)","text":"<p>cert-manager is recommended for managing webhook certificates:</p> <pre><code># Install cert-manager\nkubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.14.0/cert-manager.yaml\n\n# Wait for cert-manager to be ready\nkubectl wait --for=condition=Available deployment --all -n cert-manager --timeout=300s\n</code></pre> <p>Without cert-manager</p> <p>If you prefer not to use cert-manager, you can use self-signed certificates or disable webhooks entirely. See the Configuration for details.</p>"},{"location":"installation/#installation-methods","title":"Installation Methods","text":""},{"location":"installation/#helm-recommended","title":"Helm (Recommended)","text":"<p>Helm is the recommended installation method as it provides the most flexibility.</p>"},{"location":"installation/#add-the-repository","title":"Add the Repository","text":"<pre><code>helm repo add vault-access-operator https://panteparak.github.io/vault-access-operator/charts\nhelm repo update\n</code></pre>"},{"location":"installation/#basic-installation","title":"Basic Installation","text":"<pre><code>helm install vault-access-operator vault-access-operator/vault-access-operator \\\n  --namespace vault-access-operator-system \\\n  --create-namespace\n</code></pre>"},{"location":"installation/#installation-with-custom-values","title":"Installation with Custom Values","text":"<pre><code># Using a values file\nhelm install vault-access-operator vault-access-operator/vault-access-operator \\\n  --namespace vault-access-operator-system \\\n  --create-namespace \\\n  -f my-values.yaml\n\n# Or with inline values\nhelm install vault-access-operator vault-access-operator/vault-access-operator \\\n  --namespace vault-access-operator-system \\\n  --create-namespace \\\n  --set replicaCount=3 \\\n  --set logging.level=debug\n</code></pre>"},{"location":"installation/#production-installation","title":"Production Installation","text":"<p>For production environments, use the production values file:</p> <pre><code>helm install vault-access-operator vault-access-operator/vault-access-operator \\\n  --namespace vault-access-operator-system \\\n  --create-namespace \\\n  -f https://raw.githubusercontent.com/panteparak/vault-access-operator/main/charts/vault-access-operator/examples/values-production.yaml\n</code></pre> <p>See Configuration Examples for more example values files.</p>"},{"location":"installation/#kubectl","title":"kubectl","text":"<p>For simple installations without Helm:</p> <pre><code># Apply the installation manifest\nkubectl apply -f https://raw.githubusercontent.com/panteparak/vault-access-operator/main/dist/install.yaml\n</code></pre> <p>This installs the operator with default settings. To customize, download and modify the manifest:</p> <pre><code># Download the manifest\ncurl -sL https://raw.githubusercontent.com/panteparak/vault-access-operator/main/dist/install.yaml -o install.yaml\n\n# Edit as needed\nvim install.yaml\n\n# Apply\nkubectl apply -f install.yaml\n</code></pre>"},{"location":"installation/#from-source","title":"From Source","text":"<p>For development or when you need to build from source:</p> <pre><code># Clone the repository\ngit clone https://github.com/panteparak/vault-access-operator.git\ncd vault-access-operator\n\n# Install CRDs\nmake install\n\n# Deploy the operator\nmake deploy IMG=ghcr.io/panteparak/vault-access-operator:latest\n</code></pre> <p>To run locally for development:</p> <pre><code># Run the operator locally (outside the cluster)\nmake run\n</code></pre>"},{"location":"installation/#verify-installation","title":"Verify Installation","text":"<p>After installation, verify that everything is running correctly:</p>"},{"location":"installation/#check-the-operator-pod","title":"Check the Operator Pod","text":"<pre><code>kubectl get pods -n vault-access-operator-system\n</code></pre> <p>Expected output:</p> <pre><code>NAME                                                         READY   STATUS    RESTARTS   AGE\nvault-access-operator-controller-manager-xxxxxxxxxx-xxxxx    1/1     Running   0          1m\n</code></pre>"},{"location":"installation/#check-crds","title":"Check CRDs","text":"<pre><code>kubectl get crds | grep vault.platform.io\n</code></pre> <p>Expected output:</p> <pre><code>vaultclusterpolicies.vault.platform.io    2024-01-15T10:00:00Z\nvaultclusterroles.vault.platform.io       2024-01-15T10:00:00Z\nvaultconnections.vault.platform.io        2024-01-15T10:00:00Z\nvaultpolicies.vault.platform.io           2024-01-15T10:00:00Z\nvaultroles.vault.platform.io              2024-01-15T10:00:00Z\n</code></pre>"},{"location":"installation/#check-operator-logs","title":"Check Operator Logs","text":"<pre><code>kubectl logs -n vault-access-operator-system -l control-plane=controller-manager\n</code></pre>"},{"location":"installation/#check-webhooks-if-enabled","title":"Check Webhooks (if enabled)","text":"<pre><code>kubectl get validatingwebhookconfigurations | grep vault\n</code></pre>"},{"location":"installation/#configure-vault-for-the-operator","title":"Configure Vault for the Operator","text":"<p>Before creating resources, you need to configure Vault to allow the operator to manage policies and roles.</p>"},{"location":"installation/#create-operator-policy-in-vault","title":"Create Operator Policy in Vault","text":"<pre><code>vault policy write vault-access-operator - &lt;&lt;EOF\n# Manage policies\npath \"sys/policies/acl/*\" {\n  capabilities = [\"create\", \"read\", \"update\", \"delete\", \"list\"]\n}\n\n# List policies\npath \"sys/policies/acl\" {\n  capabilities = [\"list\"]\n}\n\n# Manage Kubernetes auth roles\npath \"auth/kubernetes/role/*\" {\n  capabilities = [\"create\", \"read\", \"update\", \"delete\", \"list\"]\n}\n\n# List auth roles\npath \"auth/kubernetes/role\" {\n  capabilities = [\"list\"]\n}\n\n# Check Vault health\npath \"sys/health\" {\n  capabilities = [\"read\"]\n}\n\n# Read auth configuration\npath \"auth/kubernetes/config\" {\n  capabilities = [\"read\", \"update\"]\n}\n\n# Manage auth methods (for bootstrap)\npath \"sys/auth\" {\n  capabilities = [\"read\"]\n}\n\npath \"sys/auth/*\" {\n  capabilities = [\"sudo\", \"create\", \"read\", \"update\", \"delete\", \"list\"]\n}\nEOF\n</code></pre>"},{"location":"installation/#create-kubernetes-auth-role","title":"Create Kubernetes Auth Role","text":"<pre><code>vault write auth/kubernetes/role/vault-access-operator \\\n    bound_service_account_names=vault-access-operator-controller-manager \\\n    bound_service_account_namespaces=vault-access-operator-system \\\n    policies=vault-access-operator \\\n    ttl=1h\n</code></pre>"},{"location":"installation/#uninstallation","title":"Uninstallation","text":""},{"location":"installation/#helm","title":"Helm","text":"<pre><code># Uninstall the operator\nhelm uninstall vault-access-operator -n vault-access-operator-system\n\n# Optionally delete CRDs (this will delete all managed resources!)\nkubectl delete crds \\\n  vaultconnections.vault.platform.io \\\n  vaultpolicies.vault.platform.io \\\n  vaultclusterpolicies.vault.platform.io \\\n  vaultroles.vault.platform.io \\\n  vaultclusterroles.vault.platform.io\n\n# Delete the namespace\nkubectl delete namespace vault-access-operator-system\n</code></pre>"},{"location":"installation/#kubectl_1","title":"kubectl","text":"<pre><code>kubectl delete -f https://raw.githubusercontent.com/panteparak/vault-access-operator/main/dist/install.yaml\n</code></pre>"},{"location":"installation/#next-steps","title":"Next Steps","text":"<ul> <li>Follow the Quick Start to create your first resources</li> <li>Read the Configuration Reference for all available options</li> <li>Check the API Reference for CRD documentation</li> </ul>"},{"location":"quickstart/","title":"Quick Start","text":"<p>This guide walks you through creating your first Vault policies and roles in 5 minutes.</p> <p>Prerequisites</p> <p>Before starting, ensure you have completed the Installation guide and have a running operator.</p>"},{"location":"quickstart/#step-1-create-a-vaultconnection","title":"Step 1: Create a VaultConnection","text":"<p>The VaultConnection resource establishes the connection between the operator and your Vault server.</p>"},{"location":"quickstart/#prepare-vault","title":"Prepare Vault","text":"<p>First, create a policy in Vault that allows the operator to manage policies and roles:</p> <pre><code>vault policy write vault-access-operator - &lt;&lt;EOF\n# Manage policies\npath \"sys/policies/acl/*\" {\n  capabilities = [\"create\", \"read\", \"update\", \"delete\", \"list\"]\n}\npath \"sys/policies/acl\" {\n  capabilities = [\"list\"]\n}\n\n# Manage Kubernetes auth roles\npath \"auth/kubernetes/role/*\" {\n  capabilities = [\"create\", \"read\", \"update\", \"delete\", \"list\"]\n}\npath \"auth/kubernetes/role\" {\n  capabilities = [\"list\"]\n}\nEOF\n\n# Create a Kubernetes auth role for the operator\nvault write auth/kubernetes/role/vault-access-operator \\\n    bound_service_account_names=vault-access-operator-controller-manager \\\n    bound_service_account_namespaces=vault-access-operator-system \\\n    policies=vault-access-operator \\\n    ttl=1h\n</code></pre>"},{"location":"quickstart/#create-vaultconnection-resource","title":"Create VaultConnection Resource","text":"<pre><code># vault-connection.yaml\napiVersion: vault.platform.io/v1alpha1\nkind: VaultConnection\nmetadata:\n  name: vault-primary\nspec:\n  address: https://vault.example.com:8200\n  auth:\n    kubernetes:\n      role: vault-access-operator\n  tls:\n    skipVerify: false  # Set to true for testing only\n</code></pre> <p>Apply the connection:</p> <pre><code>kubectl apply -f vault-connection.yaml\n</code></pre> <p>Verify the connection is active:</p> <pre><code>kubectl get vaultconnection vault-primary\n</code></pre> <p>Expected output:</p> <pre><code>NAME            ADDRESS                          PHASE    VERSION   AGE\nvault-primary   https://vault.example.com:8200   Active   1.15.0    30s\n</code></pre>"},{"location":"quickstart/#step-2-create-a-vaultpolicy","title":"Step 2: Create a VaultPolicy","text":"<p>Now create a Vault policy using the operator.</p>"},{"location":"quickstart/#namespace-scoped-policy-vaultpolicy","title":"Namespace-scoped Policy (VaultPolicy)","text":"<pre><code># app-secrets-policy.yaml\napiVersion: vault.platform.io/v1alpha1\nkind: VaultPolicy\nmetadata:\n  name: app-secrets\n  namespace: my-app\nspec:\n  connectionRef: vault-primary\n  rules:\n    - path: \"secret/data/{{namespace}}/*\"\n      capabilities: [read, list]\n      description: \"Read secrets for this namespace\"\n</code></pre> <pre><code># Create the namespace\nkubectl create namespace my-app\n\n# Apply the policy\nkubectl apply -f app-secrets-policy.yaml\n</code></pre> <p>The policy will be created in Vault with the name <code>my-app-app-secrets</code>, and <code>{{namespace}}</code> will be substituted with <code>my-app</code>.</p>"},{"location":"quickstart/#cluster-wide-policy-vaultclusterpolicy","title":"Cluster-wide Policy (VaultClusterPolicy)","text":"<pre><code># shared-secrets-policy.yaml\napiVersion: vault.platform.io/v1alpha1\nkind: VaultClusterPolicy\nmetadata:\n  name: shared-secrets-reader\nspec:\n  connectionRef: vault-primary\n  rules:\n    - path: \"secret/data/shared/*\"\n      capabilities: [read, list]\n      description: \"Read shared secrets\"\n</code></pre> <pre><code>kubectl apply -f shared-secrets-policy.yaml\n</code></pre> <p>Verify the policies:</p> <pre><code>kubectl get vaultpolicy -n my-app\nkubectl get vaultclusterpolicy\n</code></pre>"},{"location":"quickstart/#step-3-create-a-vaultrole","title":"Step 3: Create a VaultRole","text":"<p>Bind service accounts to the policies you created.</p>"},{"location":"quickstart/#namespace-scoped-role-vaultrole","title":"Namespace-scoped Role (VaultRole)","text":"<pre><code># app-role.yaml\napiVersion: vault.platform.io/v1alpha1\nkind: VaultRole\nmetadata:\n  name: app-role\n  namespace: my-app\nspec:\n  connectionRef: vault-primary\n  serviceAccounts:\n    - default\n  policies:\n    - kind: VaultPolicy\n      name: app-secrets\n    - kind: VaultClusterPolicy\n      name: shared-secrets-reader\n  tokenTTL: 1h\n  tokenMaxTTL: 4h\n</code></pre> <pre><code>kubectl apply -f app-role.yaml\n</code></pre>"},{"location":"quickstart/#cluster-wide-role-vaultclusterrole","title":"Cluster-wide Role (VaultClusterRole)","text":"<pre><code># platform-role.yaml\napiVersion: vault.platform.io/v1alpha1\nkind: VaultClusterRole\nmetadata:\n  name: platform-services\nspec:\n  connectionRef: vault-primary\n  serviceAccounts:\n    - name: monitoring-agent\n      namespace: monitoring\n    - name: platform-controller\n      namespace: platform-system\n  policies:\n    - kind: VaultClusterPolicy\n      name: shared-secrets-reader\n  tokenTTL: 1h\n</code></pre> <pre><code>kubectl apply -f platform-role.yaml\n</code></pre> <p>Verify the roles:</p> <pre><code>kubectl get vaultrole -n my-app\nkubectl get vaultclusterrole\n</code></pre>"},{"location":"quickstart/#step-4-test-authentication","title":"Step 4: Test Authentication","text":"<p>Create a test pod to verify everything works:</p> <pre><code># test-pod.yaml\napiVersion: v1\nkind: Pod\nmetadata:\n  name: vault-test\n  namespace: my-app\nspec:\n  serviceAccountName: default\n  containers:\n    - name: vault\n      image: hashicorp/vault:latest\n      command: [\"sleep\", \"infinity\"]\n      env:\n        - name: VAULT_ADDR\n          value: \"https://vault.example.com:8200\"\n</code></pre> <pre><code>kubectl apply -f test-pod.yaml\n</code></pre> <p>Test Vault authentication:</p> <pre><code># Get into the pod\nkubectl exec -it vault-test -n my-app -- /bin/sh\n\n# Inside the pod, authenticate to Vault\nvault login -method=kubernetes role=my-app-app-role\n\n# Test reading a secret (create one in Vault first)\nvault kv get secret/my-app/test\n\n# This should fail (policy boundary enforcement)\nvault kv get secret/other-namespace/secret\n</code></pre>"},{"location":"quickstart/#summary","title":"Summary","text":"<p>You've successfully:</p> <ol> <li>Connected the operator to your Vault server using <code>VaultConnection</code></li> <li>Created policies using <code>VaultPolicy</code> (namespace-scoped) and <code>VaultClusterPolicy</code> (cluster-wide)</li> <li>Created roles using <code>VaultRole</code> and <code>VaultClusterRole</code> to bind service accounts to policies</li> <li>Tested Vault authentication from a Kubernetes pod</li> </ol>"},{"location":"quickstart/#next-steps","title":"Next Steps","text":"<ul> <li>Read the API Reference for detailed CRD documentation</li> <li>Explore Configuration Examples for production setups</li> <li>Check the Troubleshooting guide if you encounter issues</li> </ul>"},{"location":"quickstart/#quick-reference","title":"Quick Reference","text":"Resource Scope Description VaultConnection Cluster Establishes connection to Vault VaultPolicy Namespaced Namespace-scoped Vault policy VaultClusterPolicy Cluster Cluster-wide Vault policy VaultRole Namespaced Namespace-scoped Kubernetes auth role VaultClusterRole Cluster Cluster-wide Kubernetes auth role"},{"location":"troubleshooting/","title":"Troubleshooting Guide","text":"<p>This guide helps you diagnose and resolve common issues with the Vault Access Operator.</p>"},{"location":"troubleshooting/#table-of-contents","title":"Table of Contents","text":"<ul> <li>Common Issues</li> <li>VaultConnection Issues</li> <li>VaultPolicy Issues</li> <li>VaultRole Issues</li> <li>Webhook Issues</li> <li>Debugging Techniques</li> <li>Log Analysis</li> <li>Status Conditions Explained</li> </ul>"},{"location":"troubleshooting/#common-issues","title":"Common Issues","text":""},{"location":"troubleshooting/#vaultconnection-issues","title":"VaultConnection Issues","text":""},{"location":"troubleshooting/#connection-stuck-in-pending-phase","title":"Connection Stuck in \"Pending\" Phase","text":"<p>Symptoms: <pre><code>kubectl get vaultconnection\nNAME            ADDRESS                          PHASE     VERSION   AGE\nvault-primary   https://vault.example.com:8200   Pending             5m\n</code></pre></p> <p>Possible Causes:</p> <ol> <li> <p>Operator not running: Check if the operator pod is running.    <pre><code>kubectl get pods -n vault-access-operator-system\n</code></pre></p> </li> <li> <p>Invalid Vault address: Verify the address is correct and reachable.    <pre><code>kubectl describe vaultconnection vault-primary\n</code></pre></p> </li> <li> <p>Network connectivity: The operator cannot reach Vault.    <pre><code># Test from a pod in the same namespace as the operator\nkubectl run -it --rm debug --image=curlimages/curl -- curl -k https://vault.example.com:8200/v1/sys/health\n</code></pre></p> </li> </ol>"},{"location":"troubleshooting/#connection-in-error-phase","title":"Connection in \"Error\" Phase","text":"<p>Symptoms: <pre><code>kubectl get vaultconnection\nNAME            ADDRESS                          PHASE   VERSION   AGE\nvault-primary   https://vault.example.com:8200   Error             5m\n</code></pre></p> <p>Check the error message: <pre><code>kubectl describe vaultconnection vault-primary\n</code></pre></p> <p>Common error causes:</p> <ol> <li>TLS Certificate Issues</li> <li>Error: <code>x509: certificate signed by unknown authority</code></li> <li> <p>Solution: Provide the correct CA certificate or set <code>skipVerify: true</code> (not recommended for production).    <pre><code>spec:\n  tls:\n    caSecretRef:\n      name: vault-ca-cert\n      namespace: vault-access-operator-system\n      key: ca.crt\n</code></pre></p> </li> <li> <p>Authentication Failure</p> </li> <li>Error: <code>permission denied</code> or <code>invalid role</code></li> <li> <p>Solution: Verify the Vault role exists and the service account is bound correctly.    <pre><code># Check if the role exists in Vault\nvault read auth/kubernetes/role/vault-access-operator\n\n# Verify the operator service account\nkubectl get sa -n vault-access-operator-system\n</code></pre></p> </li> <li> <p>Vault Sealed</p> </li> <li>Error: <code>Vault is sealed</code></li> <li>Solution: Unseal the Vault server.    <pre><code>vault status\nvault operator unseal\n</code></pre></li> </ol>"},{"location":"troubleshooting/#connection-authentication-failures","title":"Connection Authentication Failures","text":"<p>Symptoms: <pre><code>Error: failed to authenticate: permission denied\n</code></pre></p> <p>Debugging steps:</p> <ol> <li> <p>Verify Kubernetes auth is enabled: <pre><code>vault auth list\n</code></pre></p> </li> <li> <p>Check the Vault role configuration: <pre><code>vault read auth/kubernetes/role/vault-access-operator\n</code></pre></p> </li> <li> <p>Verify service account binding: <pre><code># The role should allow:\n# - bound_service_account_names: vault-access-operator-controller-manager\n# - bound_service_account_namespaces: vault-access-operator-system\n</code></pre></p> </li> <li> <p>Test authentication manually: <pre><code># Get a shell in the operator pod\nkubectl exec -it deploy/vault-access-operator-controller-manager \\\n  -n vault-access-operator-system -- /bin/sh\n\n# Check the service account token\ncat /var/run/secrets/kubernetes.io/serviceaccount/token\n</code></pre></p> </li> </ol>"},{"location":"troubleshooting/#vaultpolicy-issues","title":"VaultPolicy Issues","text":""},{"location":"troubleshooting/#policy-stuck-in-syncing-phase","title":"Policy Stuck in \"Syncing\" Phase","text":"<p>Symptoms: <pre><code>kubectl get vaultpolicy -n my-app\nNAME          VAULT NAME         PHASE     RULES   AGE\napp-secrets   my-app-app-secrets Syncing   3       5m\n</code></pre></p> <p>Possible causes:</p> <ol> <li> <p>VaultConnection not ready: <pre><code>kubectl get vaultconnection\n# Ensure the referenced connection is in \"Active\" phase\n</code></pre></p> </li> <li> <p>Insufficient Vault permissions: <pre><code># Check operator logs\nkubectl logs -n vault-access-operator-system deploy/vault-access-operator-controller-manager\n\n# Ensure the Vault policy allows policy management\nvault policy read vault-access-operator\n</code></pre></p> </li> </ol>"},{"location":"troubleshooting/#policy-in-conflict-phase","title":"Policy in \"Conflict\" Phase","text":"<p>Symptoms: <pre><code>kubectl get vaultpolicy -n my-app\nNAME          VAULT NAME         PHASE      RULES   AGE\napp-secrets   my-app-app-secrets Conflict   3       5m\n</code></pre></p> <p>Explanation: A policy with the same name already exists in Vault and is either: - Managed by a different Kubernetes resource - Not managed by the operator at all</p> <p>Solutions:</p> <ol> <li> <p>Use Adopt conflict policy: <pre><code>spec:\n  conflictPolicy: Adopt  # Take over the existing policy\n</code></pre></p> </li> <li> <p>Delete the existing policy from Vault: <pre><code>vault policy delete my-app-app-secrets\n</code></pre></p> </li> <li> <p>Rename your VaultPolicy resource: <pre><code>metadata:\n  name: app-secrets-v2  # Will create: my-app-app-secrets-v2\n</code></pre></p> </li> </ol>"},{"location":"troubleshooting/#namespace-boundary-validation-error","title":"Namespace Boundary Validation Error","text":"<p>Symptoms: <pre><code>Error: validation failed: rule[0]: path \"secret/data/*\" must contain {{namespace}} when namespace boundary enforcement is enabled\n</code></pre></p> <p>Solution: Add the <code>{{namespace}}</code> variable to your paths, or disable namespace boundary enforcement:</p> <p>Option 1: Add namespace variable (recommended for multi-tenant environments): <pre><code>spec:\n  enforceNamespaceBoundary: true  # Explicitly enabled (default is false)\n  rules:\n    - path: \"secret/data/{{namespace}}/*\"  # Correct\n      capabilities: [read, list]\n</code></pre></p> <p>Option 2: Disable enforcement (default behavior): <pre><code>spec:\n  enforceNamespaceBoundary: false  # This is the default\n  rules:\n    - path: \"secret/data/*\"\n      capabilities: [read, list]\n</code></pre></p>"},{"location":"troubleshooting/#wildcard-before-namespace-error","title":"Wildcard Before Namespace Error","text":"<p>Symptoms: <pre><code>Error: validation failed: rule[0]: path \"secret/*/{{namespace}}/data\" contains wildcard (*) before {{namespace}} which is a security risk\n</code></pre></p> <p>Explanation: Having a wildcard before <code>{{namespace}}</code> could allow access to secrets in other namespaces.</p> <p>Solution: Restructure your path: <pre><code># Bad\n- path: \"secret/*/{{namespace}}/data\"\n\n# Good\n- path: \"secret/data/{{namespace}}/*\"\n- path: \"kv/{{namespace}}/data/*\"\n</code></pre></p>"},{"location":"troubleshooting/#vaultrole-issues","title":"VaultRole Issues","text":""},{"location":"troubleshooting/#role-in-error-phase-with-policynotfound","title":"Role in \"Error\" Phase with PolicyNotFound","text":"<p>Symptoms: <pre><code>kubectl describe vaultrole app-role -n my-app\n# Status shows: policy VaultPolicy \"missing-policy\" not found in namespace \"my-app\"\n</code></pre></p> <p>Solutions:</p> <ol> <li> <p>Create the missing policy: <pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultPolicy\nmetadata:\n  name: missing-policy\n  namespace: my-app\nspec:\n  # ... policy configuration\n</code></pre></p> </li> <li> <p>Fix the policy reference: <pre><code>spec:\n  policies:\n    - kind: VaultPolicy\n      name: correct-policy-name\n</code></pre></p> </li> <li> <p>If referencing a policy in another namespace: <pre><code>spec:\n  policies:\n    - kind: VaultPolicy\n      name: shared-policy\n      namespace: shared-namespace\n</code></pre></p> </li> </ol>"},{"location":"troubleshooting/#service-account-not-authorized","title":"Service Account Not Authorized","text":"<p>Symptoms: - Application pods cannot authenticate to Vault - Error: <code>role not found</code> or <code>service account not authorized</code></p> <p>Debugging steps:</p> <ol> <li> <p>Check the VaultRole status: <pre><code>kubectl get vaultrole app-role -n my-app -o yaml\n# Verify boundServiceAccounts in status\n</code></pre></p> </li> <li> <p>Verify the service account exists: <pre><code>kubectl get sa -n my-app\n</code></pre></p> </li> <li> <p>Check the role in Vault: <pre><code>vault read auth/kubernetes/role/my-app-app-role\n</code></pre></p> </li> <li> <p>Test authentication: <pre><code>kubectl run -it --rm debug \\\n  --image=hashicorp/vault \\\n  --serviceaccount=app-service-account \\\n  -n my-app -- \\\n  vault login -method=kubernetes role=my-app-app-role\n</code></pre></p> </li> </ol>"},{"location":"troubleshooting/#webhook-issues","title":"Webhook Issues","text":""},{"location":"troubleshooting/#webhook-certificate-errors","title":"Webhook Certificate Errors","text":"<p>Symptoms: <pre><code>Error creating: Internal error occurred: failed calling webhook:\nx509: certificate signed by unknown authority\n</code></pre></p> <p>Solutions:</p> <ol> <li> <p>If using cert-manager, verify the certificate: <pre><code>kubectl get certificate -n vault-access-operator-system\nkubectl describe certificate vault-access-operator-webhook-cert \\\n  -n vault-access-operator-system\n</code></pre></p> </li> <li> <p>Check cert-manager is working: <pre><code>kubectl get pods -n cert-manager\nkubectl logs -n cert-manager deploy/cert-manager\n</code></pre></p> </li> <li> <p>Restart the operator to pick up new certificate: <pre><code>kubectl rollout restart deployment vault-access-operator-controller-manager \\\n  -n vault-access-operator-system\n</code></pre></p> </li> </ol>"},{"location":"troubleshooting/#webhook-timeout","title":"Webhook Timeout","text":"<p>Symptoms: <pre><code>Error: context deadline exceeded (Client.Timeout exceeded while awaiting headers)\n</code></pre></p> <p>Solutions:</p> <ol> <li> <p>Check operator health: <pre><code>kubectl get pods -n vault-access-operator-system\nkubectl logs -n vault-access-operator-system deploy/vault-access-operator-controller-manager\n</code></pre></p> </li> <li> <p>Increase webhook timeout: <pre><code># In Helm values\nwebhook:\n  timeoutSeconds: 30\n</code></pre></p> </li> <li> <p>Check network policies: <pre><code>kubectl get networkpolicy -n vault-access-operator-system\n</code></pre></p> </li> </ol>"},{"location":"troubleshooting/#debugging-techniques","title":"Debugging Techniques","text":""},{"location":"troubleshooting/#enable-debug-logging","title":"Enable Debug Logging","text":"<p>Increase log verbosity for more detailed output:</p> <pre><code># Helm values\nlogging:\n  level: debug\n</code></pre> <p>Or set environment variable: <pre><code>kubectl set env deployment/vault-access-operator-controller-manager \\\n  -n vault-access-operator-system \\\n  -- ZAP_LOG_LEVEL=debug\n</code></pre></p>"},{"location":"troubleshooting/#check-resource-events","title":"Check Resource Events","text":"<pre><code>kubectl get events --field-selector involvedObject.name=app-secrets -n my-app\n</code></pre>"},{"location":"troubleshooting/#inspect-resource-details","title":"Inspect Resource Details","text":"<pre><code># Full resource with status\nkubectl get vaultpolicy app-secrets -n my-app -o yaml\n\n# Just the status\nkubectl get vaultpolicy app-secrets -n my-app -o jsonpath='{.status}'\n\n# Just conditions\nkubectl get vaultpolicy app-secrets -n my-app \\\n  -o jsonpath='{.status.conditions}' | jq .\n</code></pre>"},{"location":"troubleshooting/#test-vault-connectivity-from-operator","title":"Test Vault Connectivity from Operator","text":"<pre><code># Get a shell in the operator pod\nkubectl exec -it deploy/vault-access-operator-controller-manager \\\n  -n vault-access-operator-system -- /bin/sh\n\n# Test Vault health\nwget -qO- https://vault.example.com:8200/v1/sys/health\n\n# Check environment\nenv | grep VAULT\n</code></pre>"},{"location":"troubleshooting/#verify-crd-installation","title":"Verify CRD Installation","text":"<pre><code># List CRDs\nkubectl get crds | grep vault.platform.io\n\n# Check CRD details\nkubectl describe crd vaultpolicies.vault.platform.io\n</code></pre>"},{"location":"troubleshooting/#log-analysis","title":"Log Analysis","text":""},{"location":"troubleshooting/#operator-log-locations","title":"Operator Log Locations","text":"<pre><code># Stream logs from the operator\nkubectl logs -f -n vault-access-operator-system deploy/vault-access-operator-controller-manager\n\n# Get logs from the last hour\nkubectl logs -n vault-access-operator-system deploy/vault-access-operator-controller-manager \\\n  --since=1h\n\n# Get logs from a crashed pod\nkubectl logs -n vault-access-operator-system deploy/vault-access-operator-controller-manager \\\n  --previous\n</code></pre>"},{"location":"troubleshooting/#common-log-patterns","title":"Common Log Patterns","text":""},{"location":"troubleshooting/#successful-reconciliation","title":"Successful Reconciliation","text":"<pre><code>{\"level\":\"info\",\"ts\":\"...\",\"msg\":\"Reconciling VaultPolicy\",\"namespace\":\"my-app\",\"name\":\"app-secrets\"}\n{\"level\":\"info\",\"ts\":\"...\",\"msg\":\"VaultPolicy reconciled successfully\",\"namespace\":\"my-app\",\"name\":\"app-secrets\",\"vaultName\":\"my-app-app-secrets\"}\n</code></pre>"},{"location":"troubleshooting/#connection-error","title":"Connection Error","text":"<pre><code>{\"level\":\"error\",\"ts\":\"...\",\"msg\":\"Failed to get Vault client\",\"error\":\"connection \\\"vault-primary\\\" not ready: VaultConnection is in Pending phase\"}\n</code></pre>"},{"location":"troubleshooting/#conflict-detection","title":"Conflict Detection","text":"<pre><code>{\"level\":\"error\",\"ts\":\"...\",\"msg\":\"Conflict detected\",\"error\":\"conflict: policy \\\"my-app-app-secrets\\\": already managed by other-namespace/other-policy\"}\n</code></pre>"},{"location":"troubleshooting/#retry-scheduling","title":"Retry Scheduling","text":"<pre><code>{\"level\":\"info\",\"ts\":\"...\",\"msg\":\"Scheduling retry\",\"retryCount\":2,\"nextRetryIn\":\"20s\"}\n</code></pre>"},{"location":"troubleshooting/#filtering-logs","title":"Filtering Logs","text":"<pre><code># Only errors\nkubectl logs -n vault-access-operator-system deploy/vault-access-operator-controller-manager \\\n  | grep '\"level\":\"error\"'\n\n# Specific resource\nkubectl logs -n vault-access-operator-system deploy/vault-access-operator-controller-manager \\\n  | grep '\"name\":\"app-secrets\"'\n\n# Using jq for JSON logs\nkubectl logs -n vault-access-operator-system deploy/vault-access-operator-controller-manager \\\n  | jq 'select(.level == \"error\")'\n</code></pre>"},{"location":"troubleshooting/#status-conditions-explained","title":"Status Conditions Explained","text":""},{"location":"troubleshooting/#condition-types","title":"Condition Types","text":"Type Description Healthy State <code>Ready</code> Resource is fully reconciled and operational <code>True</code> <code>Synced</code> Resource has been successfully synced to Vault <code>True</code> <code>ConnectionReady</code> Referenced VaultConnection is available <code>True</code> <code>PoliciesResolved</code> All referenced policies have been found and resolved <code>True</code>"},{"location":"troubleshooting/#condition-reasons","title":"Condition Reasons","text":"Reason Description Action <code>Succeeded</code> Operation completed successfully None needed <code>Failed</code> Operation failed Check message and logs <code>InProgress</code> Operation is ongoing Wait for completion <code>Conflict</code> Conflict with existing Vault resource Use Adopt policy or resolve manually <code>ValidationFailed</code> Resource spec validation failed Fix spec according to error <code>ConnectionNotReady</code> VaultConnection is not active Fix VaultConnection <code>PolicyNotFound</code> Referenced policy doesn't exist Create the policy"},{"location":"troubleshooting/#reading-conditions","title":"Reading Conditions","text":"<pre><code># Get all conditions\nkubectl get vaultpolicy app-secrets -n my-app \\\n  -o jsonpath='{range .status.conditions[*]}{.type}: {.status} ({.reason}) - {.message}{\"\\n\"}{end}'\n\n# Example output:\n# Ready: False (ConnectionNotReady) - connection \"vault-primary\" not ready: VaultConnection is in Error phase\n# Synced: False (Failed) - failed to sync policy to Vault\n</code></pre>"},{"location":"troubleshooting/#interpreting-multiple-conditions","title":"Interpreting Multiple Conditions","text":"<p>Healthy resource: <pre><code>Ready: True (Succeeded) - Policy synced to Vault\nSynced: True (Succeeded) - Policy synced successfully\n</code></pre></p> <p>Connection issue: <pre><code>Ready: False (ConnectionNotReady) - connection \"vault-primary\" not ready\nSynced: False (Failed) - cannot sync without connection\n</code></pre></p> <p>Conflict detected: <pre><code>Ready: False (Conflict) - policy already exists and is managed by other-ns/other-policy\nSynced: False (Conflict) - cannot sync due to conflict\n</code></pre></p>"},{"location":"troubleshooting/#getting-help","title":"Getting Help","text":"<p>If you're still experiencing issues:</p> <ol> <li> <p>Check the GitHub Issues: github.com/panteparak/vault-access-operator/issues</p> </li> <li> <p>Collect diagnostic information: <pre><code># Export all vault resources\nkubectl get vaultconnections,vaultclusterpolicies,vaultpolicies,vaultclusterroles,vaultroles \\\n  -A -o yaml &gt; vault-resources.yaml\n\n# Get operator logs\nkubectl logs -n vault-access-operator-system deploy/vault-access-operator-controller-manager \\\n  --since=1h &gt; operator-logs.txt\n\n# Get events\nkubectl get events -A --field-selector reason!=Normal &gt; events.txt\n</code></pre></p> </li> <li> <p>Open an issue with the diagnostic information (remove any sensitive data like tokens or secrets).</p> </li> </ol>"},{"location":"api-reference/","title":"API Reference","text":"<p>This section provides detailed documentation for all Custom Resource Definitions (CRDs) provided by the Vault Access Operator.</p>"},{"location":"api-reference/#overview","title":"Overview","text":"<p>The Vault Access Operator provides five CRDs organized by scope and purpose:</p>"},{"location":"api-reference/#connection-management","title":"Connection Management","text":"CRD Scope Description VaultConnection Cluster Establishes and manages connections to Vault servers"},{"location":"api-reference/#policy-management","title":"Policy Management","text":"CRD Scope Description VaultPolicy Namespaced Manages namespace-scoped Vault policies VaultClusterPolicy Cluster Manages cluster-wide Vault policies"},{"location":"api-reference/#role-management","title":"Role Management","text":"CRD Scope Description VaultRole Namespaced Manages namespace-scoped Kubernetes auth roles VaultClusterRole Cluster Manages cluster-wide Kubernetes auth roles"},{"location":"api-reference/#api-group-and-version","title":"API Group and Version","text":"<p>All CRDs belong to the <code>vault.platform.io</code> API group with version <code>v1alpha1</code>:</p> <pre><code>apiVersion: vault.platform.io/v1alpha1\n</code></pre>"},{"location":"api-reference/#common-concepts","title":"Common Concepts","text":""},{"location":"api-reference/#connection-reference","title":"Connection Reference","text":"<p>All policy and role resources must reference a VaultConnection:</p> <pre><code>spec:\n  connectionRef: vault-primary  # Name of VaultConnection\n</code></pre>"},{"location":"api-reference/#conflict-policies","title":"Conflict Policies","text":"<p>When creating resources that may already exist in Vault:</p> Policy Behavior <code>Fail</code> Fail if a resource with the same name exists (default) <code>Adopt</code> Adopt and manage the existing resource"},{"location":"api-reference/#deletion-policies","title":"Deletion Policies","text":"<p>Control what happens when a Kubernetes resource is deleted:</p> Policy Behavior <code>Delete</code> Delete the resource from Vault (default) <code>Retain</code> Keep the resource in Vault"},{"location":"api-reference/#variable-substitution","title":"Variable Substitution","text":"<p>Policies support variable substitution in paths:</p> Variable Substituted With <code>{{namespace}}</code> The Kubernetes namespace of the resource <code>{{name}}</code> The name of the Kubernetes resource <p>Example:</p> <pre><code>rules:\n  - path: \"secret/data/{{namespace}}/{{name}}/*\"\n    capabilities: [read]\n</code></pre>"},{"location":"api-reference/#resource-phases","title":"Resource Phases","text":"<p>All resources report their current phase in status:</p> Phase Description <code>Pending</code> Resource is being processed <code>Active</code> Resource is successfully synced to Vault <code>Failed</code> Resource sync failed <code>Deleting</code> Resource is being deleted"},{"location":"api-reference/#conditions","title":"Conditions","text":"<p>Resources expose detailed conditions for troubleshooting:</p> Condition Description <code>Ready</code> Resource is ready and synced <code>Synced</code> Last sync operation succeeded <code>ConnectionReady</code> VaultConnection is available"},{"location":"api-reference/#quick-links","title":"Quick Links","text":"<ul> <li>VaultConnection - Connect to Vault</li> <li>VaultPolicy - Namespace-scoped policies</li> <li>VaultClusterPolicy - Cluster-wide policies</li> <li>VaultRole - Namespace-scoped roles</li> <li>VaultClusterRole - Cluster-wide roles</li> </ul>"},{"location":"api-reference/vaultclusterpolicy/","title":"VaultClusterPolicy","text":"<p>VaultClusterPolicy manages cluster-wide Vault policies through Kubernetes resources.</p>"},{"location":"api-reference/vaultclusterpolicy/#overview","title":"Overview","text":"<ul> <li>API Group: <code>vault.platform.io</code></li> <li>API Version: <code>v1alpha1</code></li> <li>Kind: <code>VaultClusterPolicy</code></li> <li>Scope: Cluster</li> <li>Short Name: <code>vcp</code></li> </ul>"},{"location":"api-reference/vaultclusterpolicy/#basic-example","title":"Basic Example","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultClusterPolicy\nmetadata:\n  name: shared-secrets-reader\nspec:\n  connectionRef: vault-primary\n  rules:\n    - path: \"secret/data/shared/*\"\n      capabilities: [read, list]\n      description: \"Read shared configuration\"\n</code></pre>"},{"location":"api-reference/vaultclusterpolicy/#spec-fields","title":"Spec Fields","text":""},{"location":"api-reference/vaultclusterpolicy/#required-fields","title":"Required Fields","text":"Field Type Description <code>connectionRef</code> string Name of the VaultConnection to use <code>rules</code> []PolicyRule List of policy rules (minimum 1)"},{"location":"api-reference/vaultclusterpolicy/#optional-fields","title":"Optional Fields","text":"Field Type Default Description <code>conflictPolicy</code> string <code>Fail</code> How to handle conflicts: <code>Fail</code> or <code>Adopt</code> <code>deletionPolicy</code> string <code>Delete</code> What happens on deletion: <code>Delete</code> or <code>Retain</code>"},{"location":"api-reference/vaultclusterpolicy/#policyrule","title":"PolicyRule","text":"<p>Defines a single rule in the Vault policy.</p> Field Type Description <code>path</code> string Vault path to apply the rule to <code>capabilities</code> []string Capabilities: <code>create</code>, <code>read</code>, <code>update</code>, <code>delete</code>, <code>list</code>, <code>sudo</code>, <code>deny</code> <code>description</code> string Optional description <code>parameters</code> PolicyParameters Optional parameter constraints"},{"location":"api-reference/vaultclusterpolicy/#policyparameters","title":"PolicyParameters","text":"Field Type Description <code>allowed</code> []string Allowed parameter values <code>denied</code> []string Denied parameter values <code>required</code> []string Required parameters"},{"location":"api-reference/vaultclusterpolicy/#vault-policy-naming","title":"Vault Policy Naming","text":"<p>Unlike VaultPolicy, VaultClusterPolicy uses the resource name directly as the Vault policy name:</p> Kubernetes Resource Vault Policy Name <code>shared-secrets-reader</code> <code>shared-secrets-reader</code> <code>platform-admin</code> <code>platform-admin</code>"},{"location":"api-reference/vaultclusterpolicy/#comparison-with-vaultpolicy","title":"Comparison with VaultPolicy","text":"Feature VaultPolicy VaultClusterPolicy Scope Namespaced Cluster Vault name format <code>{namespace}-{name}</code> <code>{name}</code> Variable substitution <code>{{namespace}}</code>, <code>{{name}}</code> <code>{{name}}</code> only Namespace boundary Optional enforcement N/A Use case Application-specific Shared/platform-wide"},{"location":"api-reference/vaultclusterpolicy/#status-fields","title":"Status Fields","text":"Field Type Description <code>phase</code> string Current phase: <code>Pending</code>, <code>Syncing</code>, <code>Active</code>, <code>Conflict</code>, <code>Error</code>, <code>Deleting</code> <code>vaultName</code> string Name of the policy in Vault <code>managed</code> bool Whether managed by the operator <code>rulesCount</code> int Number of rules <code>lastAppliedHash</code> string Hash of last applied spec <code>lastSyncedAt</code> time Time of last successful sync <code>lastAttemptAt</code> time Time of last sync attempt <code>retryCount</code> int Retry attempt count <code>nextRetryAt</code> time Time of next retry <code>message</code> string Additional information <code>conditions</code> []Condition Detailed conditions"},{"location":"api-reference/vaultclusterpolicy/#kubectl-output","title":"kubectl Output","text":"<pre><code>$ kubectl get vaultclusterpolicy\nNAME                    VAULT NAME              PHASE    RULES   AGE\nshared-secrets-reader   shared-secrets-reader   Active   2       5d\nplatform-admin          platform-admin          Active   3       5d\n</code></pre>"},{"location":"api-reference/vaultclusterpolicy/#examples","title":"Examples","text":""},{"location":"api-reference/vaultclusterpolicy/#shared-configuration-reader","title":"Shared Configuration Reader","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultClusterPolicy\nmetadata:\n  name: shared-config-reader\nspec:\n  connectionRef: vault-primary\n  rules:\n    - path: \"secret/data/shared/*\"\n      capabilities: [read, list]\n      description: \"Read shared configuration\"\n    - path: \"secret/data/global/config\"\n      capabilities: [read]\n      description: \"Read global config\"\n</code></pre>"},{"location":"api-reference/vaultclusterpolicy/#platform-administrator","title":"Platform Administrator","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultClusterPolicy\nmetadata:\n  name: platform-admin\nspec:\n  connectionRef: vault-primary\n  conflictPolicy: Fail\n  deletionPolicy: Delete\n  rules:\n    - path: \"secret/*\"\n      capabilities: [create, read, update, delete, list]\n      description: \"Full access to secrets\"\n    - path: \"auth/kubernetes/role/*\"\n      capabilities: [read, list]\n      description: \"Read auth roles\"\n    - path: \"sys/policies/acl/*\"\n      capabilities: [read, list]\n      description: \"Read policies\"\n</code></pre>"},{"location":"api-reference/vaultclusterpolicy/#cicd-pipeline-secrets","title":"CI/CD Pipeline Secrets","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultClusterPolicy\nmetadata:\n  name: cicd-secrets\nspec:\n  connectionRef: vault-primary\n  rules:\n    - path: \"secret/data/cicd/*\"\n      capabilities: [read, list]\n      description: \"Read CI/CD secrets\"\n    - path: \"secret/data/docker-registry\"\n      capabilities: [read]\n      description: \"Docker registry credentials\"\n    - path: \"secret/data/npm-token\"\n      capabilities: [read]\n      description: \"NPM authentication token\"\n</code></pre>"},{"location":"api-reference/vaultclusterpolicy/#pki-certificate-issuer","title":"PKI Certificate Issuer","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultClusterPolicy\nmetadata:\n  name: pki-issuer\nspec:\n  connectionRef: vault-primary\n  rules:\n    - path: \"pki/issue/internal\"\n      capabilities: [create, update]\n      description: \"Issue internal certificates\"\n    - path: \"pki/ca/pem\"\n      capabilities: [read]\n      description: \"Read CA certificate\"\n</code></pre>"},{"location":"api-reference/vaultclusterpolicy/#database-credentials-reader","title":"Database Credentials Reader","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultClusterPolicy\nmetadata:\n  name: database-readonly\nspec:\n  connectionRef: vault-primary\n  rules:\n    - path: \"database/creds/readonly\"\n      capabilities: [read]\n      description: \"Generate readonly database credentials\"\n</code></pre>"},{"location":"api-reference/vaultclusterpolicy/#retain-policy-on-delete","title":"Retain Policy on Delete","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultClusterPolicy\nmetadata:\n  name: critical-policy\nspec:\n  connectionRef: vault-primary\n  deletionPolicy: Retain  # Keep in Vault even when K8s resource is deleted\n  rules:\n    - path: \"secret/data/critical/*\"\n      capabilities: [read]\n</code></pre>"},{"location":"api-reference/vaultclusterpolicy/#see-also","title":"See Also","text":"<ul> <li>VaultPolicy - Namespace-scoped policies</li> <li>VaultClusterRole - Bind cluster policies to service accounts</li> <li>Configuration Examples - More examples</li> </ul>"},{"location":"api-reference/vaultclusterrole/","title":"VaultClusterRole","text":"<p>VaultClusterRole manages cluster-wide Kubernetes authentication roles in Vault.</p>"},{"location":"api-reference/vaultclusterrole/#overview","title":"Overview","text":"<ul> <li>API Group: <code>vault.platform.io</code></li> <li>API Version: <code>v1alpha1</code></li> <li>Kind: <code>VaultClusterRole</code></li> <li>Scope: Cluster</li> <li>Short Name: <code>vcr</code></li> </ul>"},{"location":"api-reference/vaultclusterrole/#basic-example","title":"Basic Example","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultClusterRole\nmetadata:\n  name: platform-services\nspec:\n  connectionRef: vault-primary\n  serviceAccounts:\n    - name: platform-controller\n      namespace: platform-system\n  policies:\n    - kind: VaultClusterPolicy\n      name: shared-secrets-reader\n  tokenTTL: 1h\n</code></pre>"},{"location":"api-reference/vaultclusterrole/#spec-fields","title":"Spec Fields","text":""},{"location":"api-reference/vaultclusterrole/#required-fields","title":"Required Fields","text":"Field Type Description <code>connectionRef</code> string Name of the VaultConnection to use <code>serviceAccounts</code> []ServiceAccountRef Service accounts with namespace (minimum 1) <code>policies</code> []PolicyReference Policies to attach (minimum 1)"},{"location":"api-reference/vaultclusterrole/#optional-fields","title":"Optional Fields","text":"Field Type Default Description <code>authPath</code> string From VaultConnection Mount path of Kubernetes auth method <code>conflictPolicy</code> string <code>Fail</code> How to handle conflicts: <code>Fail</code> or <code>Adopt</code> <code>deletionPolicy</code> string <code>Delete</code> What happens on deletion: <code>Delete</code> or <code>Retain</code> <code>tokenTTL</code> string Vault default Default token TTL <code>tokenMaxTTL</code> string Vault default Maximum token TTL"},{"location":"api-reference/vaultclusterrole/#serviceaccountref","title":"ServiceAccountRef","text":"<p>Reference to a Kubernetes service account.</p> Field Type Description <code>name</code> string Name of the service account <code>namespace</code> string Namespace of the service account"},{"location":"api-reference/vaultclusterrole/#policyreference","title":"PolicyReference","text":"<p>Reference to a VaultPolicy or VaultClusterPolicy.</p> Field Type Description <code>kind</code> string Policy kind: <code>VaultPolicy</code> or <code>VaultClusterPolicy</code> <code>name</code> string Name of the policy resource <code>namespace</code> string Namespace (required for VaultPolicy)"},{"location":"api-reference/vaultclusterrole/#vault-role-naming","title":"Vault Role Naming","text":"<p>Unlike VaultRole, VaultClusterRole uses the resource name directly:</p> Kubernetes Resource Vault Role Name <code>platform-services</code> <code>platform-services</code> <code>cicd-pipeline</code> <code>cicd-pipeline</code>"},{"location":"api-reference/vaultclusterrole/#comparison-with-vaultrole","title":"Comparison with VaultRole","text":"Feature VaultRole VaultClusterRole Scope Namespaced Cluster Vault name <code>{namespace}-{name}</code> <code>{name}</code> Service accounts Same namespace (names only) Any namespace (name + namespace) Use case Application-specific Cross-namespace, platform"},{"location":"api-reference/vaultclusterrole/#status-fields","title":"Status Fields","text":"Field Type Description <code>phase</code> string Current phase: <code>Pending</code>, <code>Syncing</code>, <code>Active</code>, <code>Conflict</code>, <code>Error</code>, <code>Deleting</code> <code>vaultRoleName</code> string Name of the role in Vault <code>managed</code> bool Whether managed by the operator <code>boundServiceAccounts</code> []string Resolved service account names <code>resolvedPolicies</code> []string Resolved Vault policy names <code>lastSyncedAt</code> time Time of last successful sync <code>lastAttemptAt</code> time Time of last sync attempt <code>retryCount</code> int Retry attempt count <code>nextRetryAt</code> time Time of next retry <code>message</code> string Additional information <code>conditions</code> []Condition Detailed conditions"},{"location":"api-reference/vaultclusterrole/#kubectl-output","title":"kubectl Output","text":"<pre><code>$ kubectl get vaultclusterrole\nNAME                VAULT ROLE          PHASE    POLICIES                    AGE\nplatform-services   platform-services   Active   [\"shared-secrets-reader\"]   5d\ncicd-pipeline       cicd-pipeline       Active   [\"cicd-secrets\"]            3d\n</code></pre>"},{"location":"api-reference/vaultclusterrole/#examples","title":"Examples","text":""},{"location":"api-reference/vaultclusterrole/#platform-services-role","title":"Platform Services Role","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultClusterRole\nmetadata:\n  name: platform-services\nspec:\n  connectionRef: vault-primary\n  authPath: auth/kubernetes\n  serviceAccounts:\n    - name: platform-controller\n      namespace: platform-system\n    - name: monitoring-agent\n      namespace: monitoring\n    - name: logging-collector\n      namespace: logging\n  policies:\n    - kind: VaultClusterPolicy\n      name: shared-secrets-reader\n  tokenTTL: 1h\n  tokenMaxTTL: 24h\n</code></pre>"},{"location":"api-reference/vaultclusterrole/#cicd-pipeline-role","title":"CI/CD Pipeline Role","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultClusterRole\nmetadata:\n  name: cicd-pipeline\nspec:\n  connectionRef: vault-primary\n  serviceAccounts:\n    - name: tekton-pipeline\n      namespace: tekton-pipelines\n    - name: argo-workflow\n      namespace: argo\n    - name: github-actions-runner\n      namespace: actions-runner-system\n  policies:\n    - kind: VaultClusterPolicy\n      name: cicd-secrets\n  tokenTTL: 15m\n  tokenMaxTTL: 1h\n</code></pre>"},{"location":"api-reference/vaultclusterrole/#mixed-policy-types","title":"Mixed Policy Types","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultClusterRole\nmetadata:\n  name: cross-namespace-reader\nspec:\n  connectionRef: vault-primary\n  serviceAccounts:\n    - name: aggregator\n      namespace: data-platform\n  policies:\n    # Cluster-wide policy\n    - kind: VaultClusterPolicy\n      name: shared-config-reader\n\n    # Namespace-specific policy from another namespace\n    - kind: VaultPolicy\n      name: analytics-secrets\n      namespace: analytics\n\n    # Another namespace-specific policy\n    - kind: VaultPolicy\n      name: reporting-secrets\n      namespace: reporting\n</code></pre>"},{"location":"api-reference/vaultclusterrole/#ingress-controller-role","title":"Ingress Controller Role","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultClusterRole\nmetadata:\n  name: ingress-controller\nspec:\n  connectionRef: vault-primary\n  serviceAccounts:\n    - name: nginx-ingress-controller\n      namespace: ingress-nginx\n    - name: traefik\n      namespace: traefik\n  policies:\n    - kind: VaultClusterPolicy\n      name: pki-issuer\n  tokenTTL: 30m\n</code></pre>"},{"location":"api-reference/vaultclusterrole/#external-secrets-operator-role","title":"External Secrets Operator Role","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultClusterRole\nmetadata:\n  name: external-secrets\nspec:\n  connectionRef: vault-primary\n  serviceAccounts:\n    - name: external-secrets\n      namespace: external-secrets\n  policies:\n    - kind: VaultClusterPolicy\n      name: secrets-reader-all\n  tokenTTL: 1h\n  tokenMaxTTL: 4h\n</code></pre>"},{"location":"api-reference/vaultclusterrole/#backup-service-role","title":"Backup Service Role","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultClusterRole\nmetadata:\n  name: backup-service\nspec:\n  connectionRef: vault-primary\n  conflictPolicy: Adopt\n  deletionPolicy: Retain\n  serviceAccounts:\n    - name: velero\n      namespace: velero\n    - name: backup-agent\n      namespace: backup-system\n  policies:\n    - kind: VaultClusterPolicy\n      name: backup-credentials\n  tokenTTL: 2h\n</code></pre>"},{"location":"api-reference/vaultclusterrole/#service-mesh-role","title":"Service Mesh Role","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultClusterRole\nmetadata:\n  name: service-mesh\nspec:\n  connectionRef: vault-primary\n  serviceAccounts:\n    - name: istiod\n      namespace: istio-system\n    - name: istio-proxy\n      namespace: istio-system\n  policies:\n    - kind: VaultClusterPolicy\n      name: pki-issuer\n    - kind: VaultClusterPolicy\n      name: mesh-config\n  tokenTTL: 1h\n</code></pre>"},{"location":"api-reference/vaultclusterrole/#authentication-flow","title":"Authentication Flow","text":"<p>Pods with bound service accounts can authenticate:</p> <pre><code># From a pod in platform-system namespace\nvault login -method=kubernetes role=platform-services\n</code></pre> <p>The Vault Kubernetes auth method verifies: 1. The pod's service account token is valid 2. The service account (name + namespace) is bound to the role 3. The role exists and has associated policies</p>"},{"location":"api-reference/vaultclusterrole/#see-also","title":"See Also","text":"<ul> <li>VaultRole - Namespace-scoped roles</li> <li>VaultClusterPolicy - Cluster-wide policies</li> <li>Configuration Examples - More examples</li> </ul>"},{"location":"api-reference/vaultconnection/","title":"VaultConnection","text":"<p>VaultConnection establishes and manages a connection between the operator and a HashiCorp Vault server.</p>"},{"location":"api-reference/vaultconnection/#overview","title":"Overview","text":"<ul> <li>API Group: <code>vault.platform.io</code></li> <li>API Version: <code>v1alpha1</code></li> <li>Kind: <code>VaultConnection</code></li> <li>Scope: Cluster</li> <li>Short Name: N/A</li> </ul>"},{"location":"api-reference/vaultconnection/#basic-example","title":"Basic Example","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultConnection\nmetadata:\n  name: vault-primary\nspec:\n  address: https://vault.example.com:8200\n  auth:\n    kubernetes:\n      role: vault-access-operator\n  healthCheckInterval: 30s\n</code></pre>"},{"location":"api-reference/vaultconnection/#spec-fields","title":"Spec Fields","text":""},{"location":"api-reference/vaultconnection/#required-fields","title":"Required Fields","text":"Field Type Description <code>address</code> string Vault server address (e.g., <code>https://vault.example.com:8200</code>). Must start with <code>http://</code> or <code>https://</code>. <code>auth</code> AuthConfig Authentication configuration for connecting to Vault"},{"location":"api-reference/vaultconnection/#optional-fields","title":"Optional Fields","text":"Field Type Default Description <code>tls</code> TLSConfig - TLS configuration for secure connections <code>defaults</code> ConnectionDefaults - Default paths for Vault operations <code>healthCheckInterval</code> string <code>30s</code> How often to check Vault connectivity"},{"location":"api-reference/vaultconnection/#authconfig","title":"AuthConfig","text":"<p>Defines how the operator authenticates to Vault. Multiple authentication methods are supported:</p> Field Type Description <code>bootstrap</code> BootstrapAuth One-time bootstrap authentication <code>kubernetes</code> KubernetesAuth Kubernetes service account authentication <code>token</code> TokenAuth Static token authentication <code>appRole</code> AppRoleAuth AppRole authentication <p>Authentication Priority</p> <p>If <code>bootstrap</code> is configured, the operator uses the bootstrap token initially to set up Kubernetes auth, then switches to Kubernetes auth for subsequent operations.</p>"},{"location":"api-reference/vaultconnection/#kubernetesauth","title":"KubernetesAuth","text":"<p>Recommended authentication method using Kubernetes service accounts.</p> Field Type Default Description <code>role</code> string Required Vault role to authenticate as <code>authPath</code> string <code>kubernetes</code> Mount path of the Kubernetes auth method <code>tokenDuration</code> duration <code>1h</code> Requested service account token lifetime <code>tokenReviewerRotation</code> bool <code>true</code> Enable automatic token_reviewer_jwt rotation <p>Example:</p> <pre><code>auth:\n  kubernetes:\n    role: vault-access-operator\n    authPath: kubernetes\n    tokenDuration: 1h\n</code></pre>"},{"location":"api-reference/vaultconnection/#bootstrapauth","title":"BootstrapAuth","text":"<p>One-time authentication for initial setup of Kubernetes auth.</p> Field Type Default Description <code>secretRef</code> SecretKeySelector Required Reference to bootstrap token secret <code>autoRevoke</code> bool <code>true</code> Revoke bootstrap token after setup <p>Example:</p> <pre><code>auth:\n  bootstrap:\n    secretRef:\n      name: vault-bootstrap-token\n      namespace: vault-access-operator-system\n      key: token\n    autoRevoke: true\n  kubernetes:\n    role: vault-access-operator\n</code></pre>"},{"location":"api-reference/vaultconnection/#tokenauth","title":"TokenAuth","text":"<p>Static token authentication (not recommended for production).</p> Field Type Description <code>secretRef</code> SecretKeySelector Reference to token secret"},{"location":"api-reference/vaultconnection/#approleauth","title":"AppRoleAuth","text":"<p>AppRole authentication method.</p> Field Type Default Description <code>roleId</code> string Required AppRole role ID <code>secretIdRef</code> SecretKeySelector Required Reference to secret ID <code>mountPath</code> string <code>approle</code> Mount path of AppRole auth method"},{"location":"api-reference/vaultconnection/#tlsconfig","title":"TLSConfig","text":"<p>TLS settings for secure Vault connections.</p> Field Type Default Description <code>skipVerify</code> bool <code>false</code> Skip TLS certificate verification (not recommended) <code>caSecretRef</code> SecretKeySelector - Reference to CA certificate secret <p>Example:</p> <pre><code>tls:\n  skipVerify: false\n  caSecretRef:\n    name: vault-ca-cert\n    namespace: vault-access-operator-system\n    key: ca.crt\n</code></pre>"},{"location":"api-reference/vaultconnection/#connectiondefaults","title":"ConnectionDefaults","text":"<p>Default paths for Vault operations.</p> Field Type Default Description <code>secretEnginePath</code> string - Default secret engine path <code>transitPath</code> string - Default transit engine path <code>authPath</code> string <code>auth/kubernetes</code> Default auth method path"},{"location":"api-reference/vaultconnection/#secretkeyselector","title":"SecretKeySelector","text":"<p>Reference to a key in a Kubernetes Secret.</p> Field Type Description <code>name</code> string Name of the Secret <code>namespace</code> string Namespace of the Secret (optional, defaults to resource namespace) <code>key</code> string Key within the Secret"},{"location":"api-reference/vaultconnection/#status-fields","title":"Status Fields","text":"Field Type Description <code>phase</code> string Current phase: <code>Pending</code>, <code>Active</code>, <code>Error</code>, <code>Deleting</code> <code>vaultVersion</code> string Version of the connected Vault server <code>lastHeartbeat</code> time Time of last successful health check <code>message</code> string Additional information about current state <code>conditions</code> []Condition Detailed condition information <code>authStatus</code> AuthStatus Authentication-related status"},{"location":"api-reference/vaultconnection/#authstatus","title":"AuthStatus","text":"Field Type Description <code>bootstrapComplete</code> bool Whether bootstrap has completed <code>bootstrapCompletedAt</code> time When bootstrap was completed <code>authMethod</code> string Currently active auth method <code>tokenExpiration</code> time When current Vault token expires <code>tokenLastRenewed</code> time When token was last renewed <code>tokenRenewalCount</code> int Number of token renewals <code>tokenReviewerExpiration</code> time When token_reviewer_jwt expires <code>tokenReviewerLastRefresh</code> time When token_reviewer_jwt was last refreshed"},{"location":"api-reference/vaultconnection/#kubectl-output","title":"kubectl Output","text":"<pre><code>$ kubectl get vaultconnection\nNAME            ADDRESS                          PHASE    VERSION   AGE\nvault-primary   https://vault.example.com:8200   Active   1.15.0    5d\n</code></pre>"},{"location":"api-reference/vaultconnection/#full-example","title":"Full Example","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultConnection\nmetadata:\n  name: vault-primary\nspec:\n  address: https://vault.example.com:8200\n  auth:\n    bootstrap:\n      secretRef:\n        name: vault-bootstrap-token\n        namespace: vault-access-operator-system\n        key: token\n      autoRevoke: true\n    kubernetes:\n      role: vault-access-operator\n      authPath: kubernetes\n      tokenDuration: 1h\n      tokenReviewerRotation: true\n  tls:\n    skipVerify: false\n    caSecretRef:\n      name: vault-ca-cert\n      namespace: vault-access-operator-system\n      key: ca.crt\n  defaults:\n    authPath: auth/kubernetes\n    secretEnginePath: secret\n  healthCheckInterval: 30s\n</code></pre>"},{"location":"api-reference/vaultconnection/#see-also","title":"See Also","text":"<ul> <li>Quick Start - Getting started guide</li> <li>VaultPolicy - Namespace-scoped policies</li> <li>VaultRole - Namespace-scoped roles</li> </ul>"},{"location":"api-reference/vaultpolicy/","title":"VaultPolicy","text":"<p>VaultPolicy manages namespace-scoped Vault policies through Kubernetes resources.</p>"},{"location":"api-reference/vaultpolicy/#overview","title":"Overview","text":"<ul> <li>API Group: <code>vault.platform.io</code></li> <li>API Version: <code>v1alpha1</code></li> <li>Kind: <code>VaultPolicy</code></li> <li>Scope: Namespaced</li> <li>Short Name: <code>vp</code></li> </ul>"},{"location":"api-reference/vaultpolicy/#basic-example","title":"Basic Example","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultPolicy\nmetadata:\n  name: app-secrets\n  namespace: my-app\nspec:\n  connectionRef: vault-primary\n  rules:\n    - path: \"secret/data/{{namespace}}/*\"\n      capabilities: [read, list]\n      description: \"Read application secrets\"\n</code></pre>"},{"location":"api-reference/vaultpolicy/#spec-fields","title":"Spec Fields","text":""},{"location":"api-reference/vaultpolicy/#required-fields","title":"Required Fields","text":"Field Type Description <code>connectionRef</code> string Name of the VaultConnection to use <code>rules</code> []PolicyRule List of policy rules (minimum 1)"},{"location":"api-reference/vaultpolicy/#optional-fields","title":"Optional Fields","text":"Field Type Default Description <code>conflictPolicy</code> string <code>Fail</code> How to handle conflicts: <code>Fail</code> or <code>Adopt</code> <code>deletionPolicy</code> string <code>Delete</code> What happens on deletion: <code>Delete</code> or <code>Retain</code> <code>enforceNamespaceBoundary</code> bool <code>false</code> Require <code>{{namespace}}</code> in all paths"},{"location":"api-reference/vaultpolicy/#policyrule","title":"PolicyRule","text":"<p>Defines a single rule in the Vault policy.</p> Field Type Description <code>path</code> string Vault path (supports <code>{{namespace}}</code> and <code>{{name}}</code> variables) <code>capabilities</code> []string Capabilities to grant: <code>create</code>, <code>read</code>, <code>update</code>, <code>delete</code>, <code>list</code>, <code>sudo</code>, <code>deny</code> <code>description</code> string Optional description of the rule <code>parameters</code> PolicyParameters Optional fine-grained parameter constraints"},{"location":"api-reference/vaultpolicy/#policyparameters","title":"PolicyParameters","text":"Field Type Description <code>allowed</code> []string Allowed parameter values <code>denied</code> []string Denied parameter values <code>required</code> []string Required parameters"},{"location":"api-reference/vaultpolicy/#variable-substitution","title":"Variable Substitution","text":"<p>VaultPolicy supports variable substitution in paths:</p> Variable Value Example <code>{{namespace}}</code> Kubernetes namespace <code>my-app</code> <code>{{name}}</code> Resource name <code>app-secrets</code> <p>Example:</p> <pre><code>rules:\n  - path: \"secret/data/{{namespace}}/{{name}}/*\"\n    capabilities: [read]\n</code></pre> <p>For a VaultPolicy named <code>app-secrets</code> in namespace <code>my-app</code>, this becomes: <code>secret/data/my-app/app-secrets/*</code></p>"},{"location":"api-reference/vaultpolicy/#namespace-boundary-enforcement","title":"Namespace Boundary Enforcement","text":"<p>When <code>enforceNamespaceBoundary: true</code>, all paths must contain the <code>{{namespace}}</code> variable. This prevents namespace-scoped policies from accessing secrets outside their namespace.</p> <pre><code>spec:\n  enforceNamespaceBoundary: true\n  rules:\n    # Valid - contains {{namespace}}\n    - path: \"secret/data/{{namespace}}/*\"\n      capabilities: [read]\n\n    # Invalid - would fail validation\n    # - path: \"secret/data/other-namespace/*\"\n    #   capabilities: [read]\n</code></pre>"},{"location":"api-reference/vaultpolicy/#vault-policy-naming","title":"Vault Policy Naming","text":"<p>The Vault policy name is automatically generated as <code>{namespace}-{name}</code>:</p> Kubernetes Resource Vault Policy Name <code>my-app/app-secrets</code> <code>my-app-app-secrets</code> <code>production/database</code> <code>production-database</code>"},{"location":"api-reference/vaultpolicy/#status-fields","title":"Status Fields","text":"Field Type Description <code>phase</code> string Current phase: <code>Pending</code>, <code>Syncing</code>, <code>Active</code>, <code>Conflict</code>, <code>Error</code>, <code>Deleting</code> <code>vaultName</code> string Name of the policy in Vault <code>managed</code> bool Whether the policy is managed by the operator <code>rulesCount</code> int Number of rules in the policy <code>lastAppliedHash</code> string Hash of the last applied spec <code>lastSyncedAt</code> time Time of last successful sync <code>lastAttemptAt</code> time Time of last sync attempt <code>retryCount</code> int Number of retry attempts <code>nextRetryAt</code> time Time of next retry <code>message</code> string Additional state information <code>conditions</code> []Condition Detailed conditions"},{"location":"api-reference/vaultpolicy/#kubectl-output","title":"kubectl Output","text":"<pre><code>$ kubectl get vaultpolicy -n my-app\nNAME          VAULT NAME          PHASE    RULES   AGE\napp-secrets   my-app-app-secrets  Active   2       1h\n</code></pre>"},{"location":"api-reference/vaultpolicy/#examples","title":"Examples","text":""},{"location":"api-reference/vaultpolicy/#read-only-secrets-access","title":"Read-Only Secrets Access","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultPolicy\nmetadata:\n  name: secrets-reader\n  namespace: my-app\nspec:\n  connectionRef: vault-primary\n  rules:\n    - path: \"secret/data/{{namespace}}/*\"\n      capabilities: [read, list]\n</code></pre>"},{"location":"api-reference/vaultpolicy/#full-crud-access","title":"Full CRUD Access","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultPolicy\nmetadata:\n  name: secrets-admin\n  namespace: my-app\nspec:\n  connectionRef: vault-primary\n  enforceNamespaceBoundary: true\n  rules:\n    - path: \"secret/data/{{namespace}}/*\"\n      capabilities: [create, read, update, delete, list]\n    - path: \"secret/metadata/{{namespace}}/*\"\n      capabilities: [read, list, delete]\n</code></pre>"},{"location":"api-reference/vaultpolicy/#transit-encryption","title":"Transit Encryption","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultPolicy\nmetadata:\n  name: transit-user\n  namespace: my-app\nspec:\n  connectionRef: vault-primary\n  rules:\n    - path: \"transit/encrypt/{{namespace}}-key\"\n      capabilities: [update]\n      description: \"Encrypt data\"\n    - path: \"transit/decrypt/{{namespace}}-key\"\n      capabilities: [update]\n      description: \"Decrypt data\"\n</code></pre>"},{"location":"api-reference/vaultpolicy/#retain-on-delete","title":"Retain on Delete","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultPolicy\nmetadata:\n  name: persistent-policy\n  namespace: my-app\nspec:\n  connectionRef: vault-primary\n  deletionPolicy: Retain  # Keep in Vault when K8s resource is deleted\n  rules:\n    - path: \"secret/data/{{namespace}}/*\"\n      capabilities: [read]\n</code></pre>"},{"location":"api-reference/vaultpolicy/#adopt-existing-policy","title":"Adopt Existing Policy","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultPolicy\nmetadata:\n  name: existing-policy\n  namespace: my-app\nspec:\n  connectionRef: vault-primary\n  conflictPolicy: Adopt  # Take over management of existing Vault policy\n  rules:\n    - path: \"secret/data/{{namespace}}/*\"\n      capabilities: [read]\n</code></pre>"},{"location":"api-reference/vaultpolicy/#see-also","title":"See Also","text":"<ul> <li>VaultClusterPolicy - Cluster-wide policies</li> <li>VaultRole - Bind policies to service accounts</li> <li>Configuration Examples - More examples</li> </ul>"},{"location":"api-reference/vaultrole/","title":"VaultRole","text":"<p>VaultRole manages namespace-scoped Kubernetes authentication roles in Vault.</p>"},{"location":"api-reference/vaultrole/#overview","title":"Overview","text":"<ul> <li>API Group: <code>vault.platform.io</code></li> <li>API Version: <code>v1alpha1</code></li> <li>Kind: <code>VaultRole</code></li> <li>Scope: Namespaced</li> <li>Short Name: <code>vr</code></li> </ul>"},{"location":"api-reference/vaultrole/#basic-example","title":"Basic Example","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultRole\nmetadata:\n  name: app-role\n  namespace: my-app\nspec:\n  connectionRef: vault-primary\n  serviceAccounts:\n    - default\n  policies:\n    - kind: VaultPolicy\n      name: app-secrets\n  tokenTTL: 1h\n</code></pre>"},{"location":"api-reference/vaultrole/#spec-fields","title":"Spec Fields","text":""},{"location":"api-reference/vaultrole/#required-fields","title":"Required Fields","text":"Field Type Description <code>connectionRef</code> string Name of the VaultConnection to use <code>serviceAccounts</code> []string Service account names in the same namespace (minimum 1) <code>policies</code> []PolicyReference Policies to attach (minimum 1)"},{"location":"api-reference/vaultrole/#optional-fields","title":"Optional Fields","text":"Field Type Default Description <code>authPath</code> string From VaultConnection Mount path of Kubernetes auth method <code>conflictPolicy</code> string <code>Fail</code> How to handle conflicts: <code>Fail</code> or <code>Adopt</code> <code>deletionPolicy</code> string <code>Delete</code> What happens on deletion: <code>Delete</code> or <code>Retain</code> <code>tokenTTL</code> string Vault default Default token TTL <code>tokenMaxTTL</code> string Vault default Maximum token TTL"},{"location":"api-reference/vaultrole/#policyreference","title":"PolicyReference","text":"<p>Reference to a VaultPolicy or VaultClusterPolicy.</p> Field Type Description <code>kind</code> string Policy kind: <code>VaultPolicy</code> or <code>VaultClusterPolicy</code> <code>name</code> string Name of the policy resource <code>namespace</code> string Namespace (only for VaultPolicy, defaults to same namespace)"},{"location":"api-reference/vaultrole/#vault-role-naming","title":"Vault Role Naming","text":"<p>The Vault role name is automatically generated as <code>{namespace}-{name}</code>:</p> Kubernetes Resource Vault Role Name <code>my-app/app-role</code> <code>my-app-app-role</code> <code>production/api</code> <code>production-api</code>"},{"location":"api-reference/vaultrole/#service-account-binding","title":"Service Account Binding","text":"<p>VaultRole binds service accounts from the same namespace to Vault policies:</p> <pre><code>spec:\n  serviceAccounts:\n    - default        # my-app/default\n    - app-sa         # my-app/app-sa\n    - worker-sa      # my-app/worker-sa\n</code></pre> <p>All listed service accounts will be able to authenticate to Vault using the role.</p>"},{"location":"api-reference/vaultrole/#mixed-policy-types","title":"Mixed Policy Types","text":"<p>VaultRole can reference both namespace-scoped and cluster-wide policies:</p> <pre><code>spec:\n  policies:\n    # Namespace-scoped policy (same namespace)\n    - kind: VaultPolicy\n      name: app-secrets\n\n    # Cluster-wide policy\n    - kind: VaultClusterPolicy\n      name: shared-secrets-reader\n</code></pre>"},{"location":"api-reference/vaultrole/#status-fields","title":"Status Fields","text":"Field Type Description <code>phase</code> string Current phase: <code>Pending</code>, <code>Syncing</code>, <code>Active</code>, <code>Conflict</code>, <code>Error</code>, <code>Deleting</code> <code>vaultRoleName</code> string Name of the role in Vault <code>managed</code> bool Whether managed by the operator <code>boundServiceAccounts</code> []string Resolved service account names <code>resolvedPolicies</code> []string Resolved Vault policy names <code>lastSyncedAt</code> time Time of last successful sync <code>lastAttemptAt</code> time Time of last sync attempt <code>retryCount</code> int Retry attempt count <code>nextRetryAt</code> time Time of next retry <code>message</code> string Additional information <code>conditions</code> []Condition Detailed conditions"},{"location":"api-reference/vaultrole/#kubectl-output","title":"kubectl Output","text":"<pre><code>$ kubectl get vaultrole -n my-app\nNAME       VAULT ROLE        PHASE    POLICIES                                    AGE\napp-role   my-app-app-role   Active   [\"my-app-app-secrets\",\"shared-reader\"]     1h\n</code></pre>"},{"location":"api-reference/vaultrole/#examples","title":"Examples","text":""},{"location":"api-reference/vaultrole/#basic-application-role","title":"Basic Application Role","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultRole\nmetadata:\n  name: app-role\n  namespace: my-app\nspec:\n  connectionRef: vault-primary\n  serviceAccounts:\n    - default\n  policies:\n    - kind: VaultPolicy\n      name: app-secrets\n  tokenTTL: 1h\n  tokenMaxTTL: 4h\n</code></pre>"},{"location":"api-reference/vaultrole/#multiple-service-accounts","title":"Multiple Service Accounts","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultRole\nmetadata:\n  name: backend-services\n  namespace: my-app\nspec:\n  connectionRef: vault-primary\n  serviceAccounts:\n    - api-server\n    - worker\n    - scheduler\n  policies:\n    - kind: VaultPolicy\n      name: backend-secrets\n  tokenTTL: 30m\n</code></pre>"},{"location":"api-reference/vaultrole/#mixed-policy-types_1","title":"Mixed Policy Types","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultRole\nmetadata:\n  name: full-access\n  namespace: my-app\nspec:\n  connectionRef: vault-primary\n  serviceAccounts:\n    - default\n  policies:\n    # Application-specific secrets\n    - kind: VaultPolicy\n      name: app-secrets\n\n    # Shared configuration\n    - kind: VaultClusterPolicy\n      name: shared-config-reader\n\n    # Database credentials\n    - kind: VaultClusterPolicy\n      name: database-readonly\n  tokenTTL: 1h\n</code></pre>"},{"location":"api-reference/vaultrole/#short-lived-tokens","title":"Short-lived Tokens","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultRole\nmetadata:\n  name: batch-job\n  namespace: batch\nspec:\n  connectionRef: vault-primary\n  serviceAccounts:\n    - batch-runner\n  policies:\n    - kind: VaultPolicy\n      name: batch-secrets\n  tokenTTL: 5m\n  tokenMaxTTL: 15m\n</code></pre>"},{"location":"api-reference/vaultrole/#adopt-existing-role","title":"Adopt Existing Role","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultRole\nmetadata:\n  name: legacy-role\n  namespace: my-app\nspec:\n  connectionRef: vault-primary\n  conflictPolicy: Adopt  # Take over existing Vault role\n  serviceAccounts:\n    - default\n  policies:\n    - kind: VaultPolicy\n      name: app-secrets\n</code></pre>"},{"location":"api-reference/vaultrole/#custom-auth-path","title":"Custom Auth Path","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultRole\nmetadata:\n  name: custom-auth\n  namespace: my-app\nspec:\n  connectionRef: vault-primary\n  authPath: auth/kubernetes-prod  # Non-default auth mount\n  serviceAccounts:\n    - default\n  policies:\n    - kind: VaultPolicy\n      name: app-secrets\n</code></pre>"},{"location":"api-reference/vaultrole/#authentication-flow","title":"Authentication Flow","text":"<p>Once a VaultRole is created, pods can authenticate to Vault:</p> <pre><code># Inside a pod with the bound service account\nvault login -method=kubernetes role=my-app-app-role\n</code></pre> <p>Or programmatically:</p> <pre><code>// Using vault/api\nconfig := vault.DefaultConfig()\nclient, _ := vault.NewClient(config)\n\nsecret, _ := client.Logical().Write(\"auth/kubernetes/login\", map[string]interface{}{\n    \"role\": \"my-app-app-role\",\n    \"jwt\":  serviceAccountToken,\n})\n</code></pre>"},{"location":"api-reference/vaultrole/#see-also","title":"See Also","text":"<ul> <li>VaultClusterRole - Cluster-wide roles</li> <li>VaultPolicy - Namespace-scoped policies</li> <li>Quick Start - Getting started guide</li> </ul>"},{"location":"configuration/examples/","title":"Configuration Examples","text":"<p>This page provides complete example configurations for various deployment scenarios.</p>"},{"location":"configuration/examples/#helm-values-examples","title":"Helm Values Examples","text":""},{"location":"configuration/examples/#minimal-installation","title":"Minimal Installation","text":"<p>The simplest configuration to get started:</p> <pre><code># values-minimal.yaml\nreplicaCount: 1\n\nwebhook:\n  certManager:\n    enabled: true\n\nlogging:\n  level: info\n</code></pre> <p>Install with:</p> <pre><code>helm install vault-access-operator vault-access-operator/vault-access-operator \\\n  --namespace vault-access-operator-system \\\n  --create-namespace \\\n  -f values-minimal.yaml\n</code></pre>"},{"location":"configuration/examples/#production-high-availability","title":"Production High Availability","text":"<p>A production-ready configuration with high availability:</p> <pre><code># values-production.yaml\nreplicaCount: 3\n\nresources:\n  limits:\n    cpu: \"1\"\n    memory: 512Mi\n  requests:\n    cpu: 250m\n    memory: 256Mi\n\n# Ensure pods spread across nodes\naffinity:\n  podAntiAffinity:\n    preferredDuringSchedulingIgnoredDuringExecution:\n      - weight: 100\n        podAffinityTerm:\n          labelSelector:\n            matchLabels:\n              app.kubernetes.io/name: vault-access-operator\n          topologyKey: kubernetes.io/hostname\n\n# Pod disruption budget for safe updates\npodDisruptionBudget:\n  enabled: true\n  minAvailable: 2\n\n# Priority class for critical workloads\npriorityClassName: system-cluster-critical\n\n# Leader election tuning\nleaderElection:\n  enabled: true\n  leaseDuration: 15s\n  renewDeadline: 10s\n  retryPeriod: 2s\n\n# Production logging\nlogging:\n  level: info\n  development: false\n  encoder: json\n  stacktraceLevel: error\n\n# Webhook configuration\nwebhook:\n  enabled: true\n  failurePolicy: Fail\n  certManager:\n    enabled: true\n    duration: 8760h\n    renewBefore: 720h\n\n# Metrics for observability\nmetrics:\n  enabled: true\n  secure: true\n\nserviceMonitor:\n  enabled: true\n  interval: 30s\n</code></pre>"},{"location":"configuration/examples/#with-prometheus-monitoring","title":"With Prometheus Monitoring","text":"<p>Configuration for Prometheus Operator integration:</p> <pre><code># values-monitoring.yaml\nmetrics:\n  enabled: true\n  secure: true\n  port: 8443\n  service:\n    type: ClusterIP\n    port: 8443\n    annotations:\n      prometheus.io/scrape: \"true\"\n      prometheus.io/port: \"8443\"\n\nserviceMonitor:\n  enabled: true\n  namespace: monitoring\n  labels:\n    release: prometheus\n  interval: 30s\n  scrapeTimeout: 10s\n  metricRelabelings:\n    - sourceLabels: [__name__]\n      regex: \"controller_runtime_.*\"\n      action: keep\n  relabelings:\n    - sourceLabels: [__meta_kubernetes_pod_node_name]\n      targetLabel: node\n</code></pre>"},{"location":"configuration/examples/#without-cert-manager","title":"Without cert-manager","text":"<p>If you're not using cert-manager, you can disable webhooks or use self-signed certificates:</p> Disable WebhooksSelf-signed Certificates <pre><code># values-no-webhooks.yaml\nwebhook:\n  enabled: false\n</code></pre> <pre><code># values-self-signed.yaml\nwebhook:\n  enabled: true\n  certManager:\n    enabled: false\n  selfSigned:\n    enabled: true\n    validityDays: 365\n</code></pre>"},{"location":"configuration/examples/#air-gapped-environment","title":"Air-gapped Environment","text":"<p>For environments without internet access:</p> <pre><code># values-airgapped.yaml\nimage:\n  repository: internal-registry.example.com/vault-access-operator\n  pullPolicy: IfNotPresent\n  tag: \"v0.1.0\"\n\nimagePullSecrets:\n  - name: internal-registry-creds\n\n# Pre-provisioned TLS certificates\nwebhook:\n  certManager:\n    enabled: false\n  selfSigned:\n    enabled: true\n</code></pre>"},{"location":"configuration/examples/#developmenttesting","title":"Development/Testing","text":"<p>For local development or testing:</p> <pre><code># values-dev.yaml\nreplicaCount: 1\n\nlogging:\n  level: debug\n  development: true\n  encoder: console\n\nresources:\n  limits:\n    cpu: 200m\n    memory: 128Mi\n  requests:\n    cpu: 50m\n    memory: 64Mi\n\nwebhook:\n  enabled: true\n  failurePolicy: Ignore  # Don't block on webhook failures\n  certManager:\n    enabled: true\n</code></pre>"},{"location":"configuration/examples/#crd-examples","title":"CRD Examples","text":""},{"location":"configuration/examples/#vaultconnection-examples","title":"VaultConnection Examples","text":""},{"location":"configuration/examples/#basic-kubernetes-auth","title":"Basic Kubernetes Auth","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultConnection\nmetadata:\n  name: vault-primary\nspec:\n  address: https://vault.example.com:8200\n  auth:\n    kubernetes:\n      role: vault-access-operator\n  healthCheckInterval: 30s\n</code></pre>"},{"location":"configuration/examples/#with-tls-ca-certificate","title":"With TLS CA Certificate","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultConnection\nmetadata:\n  name: vault-with-tls\nspec:\n  address: https://vault.internal:8200\n  auth:\n    kubernetes:\n      role: vault-access-operator\n      authPath: kubernetes\n  tls:\n    skipVerify: false\n    caSecretRef:\n      name: vault-ca-cert\n      namespace: vault-access-operator-system\n      key: ca.crt\n  defaults:\n    authPath: auth/kubernetes\n</code></pre>"},{"location":"configuration/examples/#bootstrap-with-token","title":"Bootstrap with Token","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultConnection\nmetadata:\n  name: vault-bootstrap\nspec:\n  address: https://vault.example.com:8200\n  auth:\n    bootstrap:\n      secretRef:\n        name: vault-bootstrap-token\n        namespace: vault-access-operator-system\n        key: token\n      autoRevoke: true\n    kubernetes:\n      role: vault-access-operator\n</code></pre>"},{"location":"configuration/examples/#approle-authentication","title":"AppRole Authentication","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultConnection\nmetadata:\n  name: vault-approle\nspec:\n  address: https://vault.example.com:8200\n  auth:\n    appRole:\n      roleId: \"your-role-id\"\n      secretIdRef:\n        name: vault-approle-secret\n        namespace: vault-access-operator-system\n        key: secret-id\n      mountPath: approle\n</code></pre>"},{"location":"configuration/examples/#vaultpolicy-examples","title":"VaultPolicy Examples","text":""},{"location":"configuration/examples/#simple-read-policy","title":"Simple Read Policy","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultPolicy\nmetadata:\n  name: app-secrets\n  namespace: my-app\nspec:\n  connectionRef: vault-primary\n  rules:\n    - path: \"secret/data/{{namespace}}/*\"\n      capabilities: [read, list]\n      description: \"Read application secrets\"\n</code></pre>"},{"location":"configuration/examples/#full-crud-access","title":"Full CRUD Access","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultPolicy\nmetadata:\n  name: app-full-access\n  namespace: my-app\nspec:\n  connectionRef: vault-primary\n  conflictPolicy: Fail\n  deletionPolicy: Delete\n  enforceNamespaceBoundary: true\n  rules:\n    - path: \"secret/data/{{namespace}}/*\"\n      capabilities: [create, read, update, delete, list]\n      description: \"Full access to namespace secrets\"\n    - path: \"secret/metadata/{{namespace}}/*\"\n      capabilities: [read, list, delete]\n      description: \"Manage secret metadata\"\n</code></pre>"},{"location":"configuration/examples/#transit-encryption-policy","title":"Transit Encryption Policy","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultPolicy\nmetadata:\n  name: transit-encrypt\n  namespace: my-app\nspec:\n  connectionRef: vault-primary\n  rules:\n    - path: \"transit/encrypt/{{namespace}}-key\"\n      capabilities: [update]\n      description: \"Encrypt data\"\n    - path: \"transit/decrypt/{{namespace}}-key\"\n      capabilities: [update]\n      description: \"Decrypt data\"\n</code></pre>"},{"location":"configuration/examples/#vaultclusterpolicy-examples","title":"VaultClusterPolicy Examples","text":""},{"location":"configuration/examples/#shared-secrets-reader","title":"Shared Secrets Reader","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultClusterPolicy\nmetadata:\n  name: shared-secrets-reader\nspec:\n  connectionRef: vault-primary\n  conflictPolicy: Fail\n  deletionPolicy: Delete\n  rules:\n    - path: \"secret/data/shared/*\"\n      capabilities: [read, list]\n      description: \"Read shared configuration\"\n    - path: \"secret/data/global/config\"\n      capabilities: [read]\n      description: \"Read global config\"\n</code></pre>"},{"location":"configuration/examples/#platform-admin-policy","title":"Platform Admin Policy","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultClusterPolicy\nmetadata:\n  name: platform-admin\nspec:\n  connectionRef: vault-primary\n  rules:\n    - path: \"secret/*\"\n      capabilities: [create, read, update, delete, list]\n    - path: \"auth/kubernetes/role/*\"\n      capabilities: [read, list]\n    - path: \"sys/policies/acl/*\"\n      capabilities: [read, list]\n</code></pre>"},{"location":"configuration/examples/#vaultrole-examples","title":"VaultRole Examples","text":""},{"location":"configuration/examples/#basic-application-role","title":"Basic Application Role","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultRole\nmetadata:\n  name: app-role\n  namespace: my-app\nspec:\n  connectionRef: vault-primary\n  serviceAccounts:\n    - default\n    - app-sa\n  policies:\n    - kind: VaultPolicy\n      name: app-secrets\n  tokenTTL: 1h\n  tokenMaxTTL: 4h\n</code></pre>"},{"location":"configuration/examples/#role-with-mixed-policies","title":"Role with Mixed Policies","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultRole\nmetadata:\n  name: app-with-shared\n  namespace: my-app\nspec:\n  connectionRef: vault-primary\n  serviceAccounts:\n    - default\n  policies:\n    - kind: VaultPolicy\n      name: app-secrets\n    - kind: VaultClusterPolicy\n      name: shared-secrets-reader\n  tokenTTL: 30m\n  tokenMaxTTL: 2h\n  deletionPolicy: Delete\n</code></pre>"},{"location":"configuration/examples/#vaultclusterrole-examples","title":"VaultClusterRole Examples","text":""},{"location":"configuration/examples/#platform-services-role","title":"Platform Services Role","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultClusterRole\nmetadata:\n  name: platform-services\nspec:\n  connectionRef: vault-primary\n  authPath: auth/kubernetes\n  serviceAccounts:\n    - name: platform-controller\n      namespace: platform-system\n    - name: monitoring-agent\n      namespace: monitoring\n  policies:\n    - kind: VaultClusterPolicy\n      name: shared-secrets-reader\n  tokenTTL: 1h\n  tokenMaxTTL: 24h\n</code></pre>"},{"location":"configuration/examples/#cicd-pipeline-role","title":"CI/CD Pipeline Role","text":"<pre><code>apiVersion: vault.platform.io/v1alpha1\nkind: VaultClusterRole\nmetadata:\n  name: cicd-pipeline\nspec:\n  connectionRef: vault-primary\n  serviceAccounts:\n    - name: tekton-pipeline\n      namespace: tekton-pipelines\n    - name: argo-workflow\n      namespace: argo\n  policies:\n    - kind: VaultClusterPolicy\n      name: cicd-secrets\n  tokenTTL: 15m\n  tokenMaxTTL: 1h\n  conflictPolicy: Adopt\n</code></pre>"},{"location":"configuration/examples/#complete-application-setup","title":"Complete Application Setup","text":"<p>Here's a complete example for setting up Vault access for a microservices application:</p> <pre><code>---\n# 1. Shared policy for all services\napiVersion: vault.platform.io/v1alpha1\nkind: VaultClusterPolicy\nmetadata:\n  name: shared-config\nspec:\n  connectionRef: vault-primary\n  rules:\n    - path: \"secret/data/shared/database\"\n      capabilities: [read]\n    - path: \"secret/data/shared/messaging\"\n      capabilities: [read]\n---\n# 2. Namespace-specific policy\napiVersion: vault.platform.io/v1alpha1\nkind: VaultPolicy\nmetadata:\n  name: api-service\n  namespace: production\nspec:\n  connectionRef: vault-primary\n  enforceNamespaceBoundary: true\n  rules:\n    - path: \"secret/data/{{namespace}}/api/*\"\n      capabilities: [read, list]\n---\n# 3. Role binding for API service\napiVersion: vault.platform.io/v1alpha1\nkind: VaultRole\nmetadata:\n  name: api-service\n  namespace: production\nspec:\n  connectionRef: vault-primary\n  serviceAccounts:\n    - api-service\n  policies:\n    - kind: VaultPolicy\n      name: api-service\n    - kind: VaultClusterPolicy\n      name: shared-config\n  tokenTTL: 1h\n---\n# 4. Service account for the application\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: api-service\n  namespace: production\n---\n# 5. Application deployment\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: api-service\n  namespace: production\nspec:\n  selector:\n    matchLabels:\n      app: api-service\n  template:\n    metadata:\n      labels:\n        app: api-service\n    spec:\n      serviceAccountName: api-service\n      containers:\n        - name: api\n          image: my-api:latest\n          env:\n            - name: VAULT_ADDR\n              value: \"https://vault.example.com:8200\"\n            - name: VAULT_AUTH_ROLE\n              value: \"production-api-service\"\n</code></pre>"},{"location":"configuration/helm-values/","title":"Helm Chart Values","text":"<p>This page documents all available Helm chart values for the Vault Access Operator.</p>"},{"location":"configuration/helm-values/#installation","title":"Installation","text":"<pre><code>helm repo add vault-access-operator https://panteparak.github.io/vault-access-operator/charts\nhelm install vault-access-operator vault-access-operator/vault-access-operator \\\n  --namespace vault-access-operator-system \\\n  --create-namespace \\\n  -f values.yaml\n</code></pre>"},{"location":"configuration/helm-values/#values-reference","title":"Values Reference","text":""},{"location":"configuration/helm-values/#basic-configuration","title":"Basic Configuration","text":"Parameter Description Default <code>replicaCount</code> Number of operator replicas <code>1</code> <code>nameOverride</code> Override the chart name <code>\"\"</code> <code>fullnameOverride</code> Override the full release name <code>\"\"</code>"},{"location":"configuration/helm-values/#image-configuration","title":"Image Configuration","text":"Parameter Description Default <code>image.repository</code> Image repository <code>ghcr.io/panteparak/vault-access-operator</code> <code>image.pullPolicy</code> Image pull policy <code>IfNotPresent</code> <code>image.tag</code> Image tag (defaults to chart appVersion) <code>\"\"</code> <code>imagePullSecrets</code> Image pull secrets for private registries <code>[]</code>"},{"location":"configuration/helm-values/#service-account","title":"Service Account","text":"Parameter Description Default <code>serviceAccount.create</code> Create a service account <code>true</code> <code>serviceAccount.annotations</code> Annotations for the service account <code>{}</code> <code>serviceAccount.name</code> Service account name <code>\"\"</code> <code>serviceAccount.automountServiceAccountToken</code> Automount service account token <code>true</code>"},{"location":"configuration/helm-values/#pod-configuration","title":"Pod Configuration","text":"Parameter Description Default <code>podAnnotations</code> Annotations for the pod <code>{}</code> <code>podLabels</code> Labels for the pod <code>{}</code> <code>nodeSelector</code> Node selector for scheduling <code>{}</code> <code>tolerations</code> Tolerations for scheduling <code>[]</code> <code>affinity</code> Affinity rules for scheduling <code>{}</code> <code>priorityClassName</code> Priority class name <code>\"\"</code>"},{"location":"configuration/helm-values/#security-context","title":"Security Context","text":"Parameter Description Default <code>podSecurityContext.runAsNonRoot</code> Run as non-root user <code>true</code> <code>podSecurityContext.seccompProfile.type</code> Seccomp profile <code>RuntimeDefault</code> <code>securityContext.allowPrivilegeEscalation</code> Allow privilege escalation <code>false</code> <code>securityContext.capabilities.drop</code> Dropped capabilities <code>[\"ALL\"]</code> <code>securityContext.readOnlyRootFilesystem</code> Read-only root filesystem <code>true</code> <code>securityContext.runAsNonRoot</code> Run as non-root <code>true</code>"},{"location":"configuration/helm-values/#resources","title":"Resources","text":"Parameter Description Default <code>resources.limits.cpu</code> CPU limit <code>500m</code> <code>resources.limits.memory</code> Memory limit <code>256Mi</code> <code>resources.requests.cpu</code> CPU request <code>100m</code> <code>resources.requests.memory</code> Memory request <code>128Mi</code>"},{"location":"configuration/helm-values/#leader-election","title":"Leader Election","text":"Parameter Description Default <code>leaderElection.enabled</code> Enable leader election <code>true</code> <code>leaderElection.leaseDuration</code> Lease duration <code>15s</code> <code>leaderElection.renewDeadline</code> Renew deadline <code>10s</code> <code>leaderElection.retryPeriod</code> Retry period <code>2s</code>"},{"location":"configuration/helm-values/#metrics","title":"Metrics","text":"Parameter Description Default <code>metrics.enabled</code> Enable metrics endpoint <code>true</code> <code>metrics.secure</code> Use HTTPS for metrics <code>true</code> <code>metrics.port</code> Metrics port <code>8443</code> <code>metrics.service.type</code> Metrics service type <code>ClusterIP</code> <code>metrics.service.port</code> Metrics service port <code>8443</code> <code>metrics.service.annotations</code> Metrics service annotations <code>{}</code>"},{"location":"configuration/helm-values/#servicemonitor-prometheus-operator","title":"ServiceMonitor (Prometheus Operator)","text":"Parameter Description Default <code>serviceMonitor.enabled</code> Create ServiceMonitor resource <code>false</code> <code>serviceMonitor.namespace</code> Namespace for ServiceMonitor <code>\"\"</code> <code>serviceMonitor.labels</code> Labels for ServiceMonitor <code>{}</code> <code>serviceMonitor.interval</code> Scrape interval <code>30s</code> <code>serviceMonitor.scrapeTimeout</code> Scrape timeout <code>10s</code> <code>serviceMonitor.metricRelabelings</code> Metric relabelings <code>[]</code> <code>serviceMonitor.relabelings</code> Relabelings <code>[]</code> <code>serviceMonitor.honorLabels</code> Honor labels <code>false</code> <code>serviceMonitor.additionalEndpoints</code> Additional endpoints <code>[]</code>"},{"location":"configuration/helm-values/#health-probes","title":"Health Probes","text":"Parameter Description Default <code>healthProbe.bindAddress</code> Health probe bind address <code>:8081</code>"},{"location":"configuration/helm-values/#webhooks","title":"Webhooks","text":"Parameter Description Default <code>webhook.enabled</code> Enable admission webhooks <code>true</code> <code>webhook.port</code> Webhook server port <code>9443</code> <code>webhook.failurePolicy</code> Webhook failure policy <code>Fail</code> <code>webhook.timeoutSeconds</code> Webhook timeout <code>10</code> <code>webhook.service.type</code> Webhook service type <code>ClusterIP</code> <code>webhook.service.port</code> Webhook service port <code>443</code> <code>webhook.service.targetPort</code> Webhook target port <code>9443</code>"},{"location":"configuration/helm-values/#webhook-certificates-cert-manager","title":"Webhook Certificates (cert-manager)","text":"Parameter Description Default <code>webhook.certManager.enabled</code> Use cert-manager for certificates <code>true</code> <code>webhook.certManager.issuerName</code> Cert-manager issuer name <code>\"\"</code> <code>webhook.certManager.issuerKind</code> Issuer kind (Issuer/ClusterIssuer) <code>\"\"</code> <code>webhook.certManager.issuerGroup</code> Issuer group <code>\"\"</code> <code>webhook.certManager.duration</code> Certificate duration <code>8760h</code> <code>webhook.certManager.renewBefore</code> Renew before expiry <code>360h</code>"},{"location":"configuration/helm-values/#webhook-certificates-self-signed","title":"Webhook Certificates (Self-signed)","text":"Parameter Description Default <code>webhook.selfSigned.enabled</code> Generate self-signed certificates <code>false</code> <code>webhook.selfSigned.validityDays</code> Certificate validity (days) <code>365</code>"},{"location":"configuration/helm-values/#vault-connection-defaults","title":"Vault Connection Defaults","text":"Parameter Description Default <code>vaultConnection.address</code> Default Vault address <code>\"\"</code> <code>vaultConnection.authPath</code> Default auth mount path <code>auth/kubernetes</code> <code>vaultConnection.role</code> Default Kubernetes auth role <code>\"\"</code> <code>vaultConnection.tls.skipVerify</code> Skip TLS verification <code>false</code> <code>vaultConnection.tls.caSecretName</code> CA certificate secret name <code>\"\"</code> <code>vaultConnection.tls.caSecretKey</code> CA certificate key <code>ca.crt</code>"},{"location":"configuration/helm-values/#logging","title":"Logging","text":"Parameter Description Default <code>logging.level</code> Log level (debug, info, error) <code>info</code> <code>logging.development</code> Development mode <code>false</code> <code>logging.encoder</code> Log encoder (json, console) <code>json</code> <code>logging.stacktraceLevel</code> Stacktrace level <code>error</code>"},{"location":"configuration/helm-values/#extra-configuration","title":"Extra Configuration","text":"Parameter Description Default <code>extraEnv</code> Additional environment variables <code>[]</code> <code>extraVolumeMounts</code> Additional volume mounts <code>[]</code> <code>extraVolumes</code> Additional volumes <code>[]</code> <code>extraArgs</code> Additional command-line arguments <code>[]</code>"},{"location":"configuration/helm-values/#network-policy","title":"Network Policy","text":"Parameter Description Default <code>networkPolicy.enabled</code> Enable network policy <code>false</code> <code>networkPolicy.ingress</code> Ingress rules <code>[]</code> <code>networkPolicy.egress</code> Egress rules <code>[]</code>"},{"location":"configuration/helm-values/#pod-disruption-budget","title":"Pod Disruption Budget","text":"Parameter Description Default <code>podDisruptionBudget.enabled</code> Enable PDB <code>false</code> <code>podDisruptionBudget.minAvailable</code> Minimum available pods <code>1</code> <code>podDisruptionBudget.maxUnavailable</code> Maximum unavailable pods <code>\"\"</code>"},{"location":"configuration/helm-values/#examples","title":"Examples","text":"<p>See the Configuration Examples page for complete example values files.</p>"},{"location":"configuration/helm-values/#minimal-installation","title":"Minimal Installation","text":"<pre><code># values-minimal.yaml\nreplicaCount: 1\nwebhook:\n  certManager:\n    enabled: true\n</code></pre>"},{"location":"configuration/helm-values/#production-installation","title":"Production Installation","text":"<pre><code># values-production.yaml\nreplicaCount: 3\nresources:\n  limits:\n    cpu: \"1\"\n    memory: 512Mi\n  requests:\n    cpu: 250m\n    memory: 256Mi\npodDisruptionBudget:\n  enabled: true\n  minAvailable: 2\naffinity:\n  podAntiAffinity:\n    preferredDuringSchedulingIgnoredDuringExecution:\n      - weight: 100\n        podAffinityTerm:\n          labelSelector:\n            matchLabels:\n              app.kubernetes.io/name: vault-access-operator\n          topologyKey: kubernetes.io/hostname\n</code></pre>"},{"location":"configuration/helm-values/#without-webhooks","title":"Without Webhooks","text":"<pre><code># values-no-webhooks.yaml\nwebhook:\n  enabled: false\n</code></pre>"},{"location":"configuration/helm-values/#with-prometheus-monitoring","title":"With Prometheus Monitoring","text":"<pre><code># values-monitoring.yaml\nmetrics:\n  enabled: true\nserviceMonitor:\n  enabled: true\n  interval: 30s\n  labels:\n    release: prometheus\n</code></pre>"}]}